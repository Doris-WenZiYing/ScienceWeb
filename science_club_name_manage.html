<!DOCTYPE html>
<html lang="zh-TW">
  <head>
    <meta charset="UTF-8" />
    <title>科學會管理系統-報名人員名單管理</title>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"
    />
    <script src="notification-center.js" defer></script>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      html,
      body {
        height: 100%;
        font-family: "Microsoft JhengHei", "Arial", sans-serif;
        background: linear-gradient(135deg, #8360c3 0%, #2ebf91 100%);
        overflow: hidden;
      }

      .header {
        height: 70px;
        background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%);
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 0 30px;
        box-shadow: 0 2px 20px rgba(0, 0, 0, 0.1);
        position: relative;
        z-index: 100;
      }

      .header::before {
        content: "";
        position: absolute;
        bottom: 0;
        left: 0;
        right: 0;
        height: 3px;
        background: linear-gradient(90deg, #8360c3 0%, #2ebf91 100%);
      }

      .header-left {
        display: flex;
        align-items: center;
        gap: 20px;
        cursor: pointer;
        transition: all 0.3s ease;
      }

      .header-left:hover {
        transform: scale(1.02);
      }

      .header img.logo {
        height: 50px;
        filter: drop-shadow(0 2px 8px rgba(0, 0, 0, 0.1));
        transition: transform 0.3s ease;
      }

      .header-left:hover .logo {
        transform: scale(1.05);
      }

      .header-title {
        font-size: 20px;
        color: #333;
        font-weight: 500;
        transition: color 0.3s ease;
      }

      .header-left:hover .header-title {
        color: #8360c3;
      }

      .header-right {
        display: flex;
        align-items: center;
        gap: 25px;
        position: relative;
      }

      .icon {
        position: relative;
        padding: 12px;
        border-radius: 50%;
        background: linear-gradient(135deg, #8360c3 0%, #2ebf91 100%);
        cursor: pointer;
        transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        box-shadow: 0 4px 15px rgba(131, 96, 195, 0.3);
        border: 2px solid rgba(255, 255, 255, 0.2);
        animation: pulse 2s infinite;
      }

      .icon:hover {
        transform: translateY(-3px) scale(1.1);
        box-shadow: 0 12px 35px rgba(131, 96, 195, 0.5);
        background: linear-gradient(135deg, #9d7ce6 0%, #3dd5a3 100%);
      }

      .icon:active {
        transform: translateY(-1px) scale(1.05);
        transition: all 0.1s ease;
      }

      .icon i {
        font-size: 20px;
        color: white;
        text-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        animation: bellShake 0.5s ease-in-out infinite alternate;
      }

      .icon::after {
        position: absolute;
        top: -5px;
        right: -5px;
        background: linear-gradient(135deg, #ff4757 0%, #ff3742 100%);
        color: white;
        border-radius: 50%;
        width: 22px;
        height: 22px;
        font-size: 12px;
        display: flex;
        align-items: center;
        justify-content: center;
        font-weight: bold;
        box-shadow: 0 2px 8px rgba(255, 71, 87, 0.4);
        border: 2px solid white;
        animation: bounce 1s ease-in-out infinite;
        text-shadow: 0 1px 2px rgba(0, 0, 0, 0.3);
      }

      @keyframes pulse {
        0% {
          box-shadow: 0 4px 15px rgba(131, 96, 195, 0.3);
        }
        50% {
          box-shadow: 0 4px 25px rgba(131, 96, 195, 0.6);
        }
        100% {
          box-shadow: 0 4px 15px rgba(131, 96, 195, 0.3);
        }
      }

      @keyframes bellShake {
        0% {
          transform: rotate(-5deg);
        }
        100% {
          transform: rotate(5deg);
        }
      }

      @keyframes bounce {
        0%,
        20%,
        50%,
        80%,
        100% {
          transform: translateY(0);
        }
        40% {
          transform: translateY(-3px);
        }
        60% {
          transform: translateY(-2px);
        }
      }

      .avatar {
        width: 45px;
        height: 45px;
        border-radius: 50%;
        background: linear-gradient(135deg, #8360c3 0%, #2ebf91 100%);
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        transition: all 0.3s ease;
        border: 3px solid #fff;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
      }

      .avatar:hover {
        transform: scale(1.1);
        box-shadow: 0 6px 20px rgba(131, 96, 195, 0.3);
      }

      .avatar i {
        font-size: 20px;
        color: white;
      }

      .dropdown {
        position: absolute;
        top: 65px;
        right: 0;
        background: white;
        border-radius: 12px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        display: none;
        min-width: 120px;
        z-index: 1000;
        overflow: hidden;
        animation: dropdownFade 0.3s ease;
      }

      @keyframes dropdownFade {
        from {
          opacity: 0;
          transform: translateY(-10px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      .dropdown a {
        display: flex;
        align-items: center;
        padding: 12px 16px;
        text-decoration: none;
        color: #333;
        font-size: 14px;
        transition: all 0.2s ease;
      }

      .dropdown a:hover {
        background: linear-gradient(135deg, #8360c3 0%, #2ebf91 100%);
        color: white;
      }

      .dropdown a i {
        margin-right: 8px;
        width: 16px;
      }

      .notification-badge {
        position: absolute;
        top: -8px;
        right: -8px;
        background: linear-gradient(135deg, #ff4757 0%, #ff6348 100%);
        color: white;
        border-radius: 50%;
        width: 26px;
        height: 26px;
        font-size: 12px;
        display: none;
        align-items: center;
        justify-content: center;
        font-weight: bold;
        border: 2px solid white;
        box-shadow: 0 4px 12px rgba(255, 71, 87, 0.5);
        animation: badgePulse 2s infinite;
      }
      .notification-badge.active {
        display: flex;
      }
      @keyframes badgePulse {
        0%,
        100% {
          transform: scale(1);
          box-shadow: 0 4px 12px rgba(255, 71, 87, 0.5);
        }
        50% {
          transform: scale(1.2);
          box-shadow: 0 6px 20px rgba(255, 71, 87, 0.8);
        }
      }
      .notification-panel {
        position: absolute;
        top: 65px;
        right: 0;
        background: white;
        border-radius: 15px;
        box-shadow: 0 15px 50px rgba(0, 0, 0, 0.15);
        display: none;
        width: 400px;
        max-height: 550px;
        z-index: 1001;
        overflow: hidden;
        animation: panelFade 0.3s ease;
        flex-direction: column;
      }
      @keyframes panelFade {
        from {
          opacity: 0;
          transform: translateY(-15px) scale(0.95);
        }
        to {
          opacity: 1;
          transform: translateY(0) scale(1);
        }
      }
      .notification-panel.active {
        display: flex;
      }
      .notification-header {
        padding: 20px 25px;
        background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
        color: white;
        display: flex;
        justify-content: space-between;
        align-items: center;
        border-bottom: 2px solid rgba(255, 255, 255, 0.1);
      }
      .notification-header h3 {
        font-size: 17px;
        font-weight: 700;
        display: flex;
        align-items: center;
        gap: 8px;
      }
      .notification-header i {
        font-size: 20px;
      }
      .mark-all-read {
        background: rgba(255, 255, 255, 0.25);
        border: 2px solid rgba(255, 255, 255, 0.3);
        color: white;
        padding: 7px 14px;
        border-radius: 12px;
        cursor: pointer;
        font-size: 12px;
        font-weight: 600;
        transition: all 0.3s ease;
      }
      .mark-all-read:hover {
        background: rgba(255, 255, 255, 0.35);
        border-color: rgba(255, 255, 255, 0.5);
        transform: translateY(-2px);
      }
      .notification-list {
        flex: 1;
        overflow-y: auto;
        padding: 10px;
      }
      .notification-item {
        padding: 16px;
        margin-bottom: 8px;
        border-radius: 12px;
        cursor: pointer;
        transition: all 0.2s ease;
        background: #f8f9fa;
        border-left: 4px solid transparent;
        position: relative;
      }
      .notification-item:hover {
        background: #f0f1f2;
        transform: translateX(4px);
      }
      .notification-item.unread {
        background: linear-gradient(135deg, #e8f9f8 0%, #f0fffe 100%);
        border-left-color: #11998e;
        box-shadow: 0 2px 8px rgba(17, 153, 142, 0.15);
      }
      .notification-item.unread::after {
        content: "";
        position: absolute;
        top: 8px;
        right: 8px;
        width: 10px;
        height: 10px;
        background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
        border-radius: 50%;
        animation: unreadPulse 2s infinite;
      }
      @keyframes unreadPulse {
        0%,
        100% {
          transform: scale(1);
          opacity: 1;
        }
        50% {
          transform: scale(1.2);
          opacity: 0.8;
        }
      }
      .notification-item-header {
        display: flex;
        justify-content: space-between;
        align-items: flex-start;
        margin-bottom: 8px;
      }
      .notification-item-title {
        font-weight: 700;
        color: #333;
        flex: 1;
        margin-right: 10px;
        font-size: 14px;
        display: flex;
        align-items: center;
        gap: 8px;
      }
      .notification-type-icon {
        width: 20px;
        height: 20px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 11px;
        color: white;
        flex-shrink: 0;
      }
      .notification-type-icon.info {
        background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
      }
      .notification-type-icon.warning {
        background: linear-gradient(135deg, #ff9800 0%, #ffc107 100%);
      }
      .notification-item-time {
        font-size: 12px;
        color: #999;
        white-space: nowrap;
      }
      .notification-item-message {
        font-size: 13px;
        color: #666;
        line-height: 1.5;
        margin-bottom: 10px;
        font-weight: 500;
      }
      .notification-actions {
        display: flex;
        gap: 8px;
      }
      .notification-btn {
        font-size: 11px;
        padding: 6px 12px;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        transition: all 0.2s ease;
        font-weight: 600;
        display: flex;
        align-items: center;
        gap: 4px;
      }
      .notification-btn-read {
        background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
        color: white;
        box-shadow: 0 2px 8px rgba(17, 153, 142, 0.2);
      }
      .notification-btn-read:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(17, 153, 142, 0.4);
      }
      .notification-btn-clear {
        background: #ffe8e8;
        color: #d32f2f;
        box-shadow: 0 2px 8px rgba(211, 47, 47, 0.1);
      }
      .notification-btn-clear:hover {
        background: #ffcccb;
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(211, 47, 47, 0.2);
      }
      .empty-notification {
        padding: 50px 20px;
        text-align: center;
        color: #999;
      }
      .empty-notification i {
        font-size: 45px;
        margin-bottom: 15px;
        opacity: 0.4;
        background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
      }
      .empty-notification p {
        font-weight: 600;
        font-size: 14px;
      }

.icon-wrapper {
        position: relative;
      }

      .main {
        display: flex;
        height: calc(100vh - 70px);
      }

      .sidebar {
        width: 280px;
        min-width: 280px;
        max-width: 280px;
        background: rgba(255, 255, 255, 0.95);
        backdrop-filter: blur(10px);
        box-shadow: 2px 0 20px rgba(0, 0, 0, 0.1);
        position: relative;
        overflow-y: auto;
        overflow-x: hidden;
      }

      .sidebar::before {
        content: "";
        position: absolute;
        top: 0;
        right: 0;
        width: 4px;
        height: 100%;
        background: linear-gradient(180deg, #8360c3 0%, #2ebf91 100%);
      }

      .menu {
        padding: 20px 0;
      }

      .menu-item:first-child {
        margin-top: 10px;
      }

      .menu::-webkit-scrollbar {
        width: 6px;
      }

      .menu::-webkit-scrollbar-thumb {
        background: rgba(131, 96, 195, 0.3);
        border-radius: 3px;
      }

      .menu-item {
        display: block;
        position: relative;
      }

      .menu-link {
        display: flex;
        align-items: center;
        padding: 15px 25px;
        text-decoration: none;
        color: #555;
        font-size: 15px;
        transition: all 0.3s ease;
        border-left: 4px solid transparent;
        cursor: pointer;
        white-space: nowrap;
      }

      .menu-link:hover,
      .menu-link.active {
        color: #8360c3;
        background: rgba(131, 96, 195, 0.1);
        border-left: 4px solid #8360c3;
        transform: translateX(5px);
      }

      .menu-link i {
        margin-right: 12px;
        width: 20px;
        font-size: 16px;
      }

      .menu-arrow {
        margin-left: auto;
        font-size: 12px;
        transition: transform 0.3s ease;
      }

      .menu-item.expanded .menu-arrow {
        transform: rotate(180deg);
      }

      .submenu {
        max-height: 0;
        overflow: hidden;
        transition: max-height 0.3s ease;
        background: rgba(131, 96, 195, 0.05);
      }

      .submenu.show {
        max-height: 500px;
      }

      .submenu-link {
        display: flex;
        align-items: center;
        padding: 12px 25px 12px 45px;
        text-decoration: none;
        color: #666;
        font-size: 14px;
        transition: all 0.3s ease;
        border-left: 4px solid transparent;
        cursor: pointer;
        white-space: nowrap;
      }

      .submenu-link:hover,
      .submenu-link.active {
        color: #8360c3;
        background: rgba(131, 96, 195, 0.1);
        border-left: 4px solid #8360c3;
        transform: translateX(5px);
      }

      .submenu-link i {
        margin-right: 10px;
        width: 16px;
        font-size: 14px;
      }

      .content {
        flex: 1;
        padding: 30px;
        overflow-y: auto;
      }

      .content::-webkit-scrollbar {
        width: 8px;
      }

      .content::-webkit-scrollbar-thumb {
        background: linear-gradient(135deg, #8360c3 0%, #2ebf91 100%);
        border-radius: 4px;
      }

      .page-header {
        background: rgba(255, 255, 255, 0.95);
        border-radius: 20px;
        padding: 25px 30px;
        margin-bottom: 25px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        display: flex;
        align-items: center;
        justify-content: space-between;
      }

      .page-title {
        display: flex;
        align-items: center;
        gap: 15px;
      }

      .page-title h1 {
        font-size: 24px;
        color: #333;
        font-weight: 600;
      }

      .page-title i {
        font-size: 28px;
        color: #8360c3;
      }

      .search-export {
        display: flex;
        gap: 15px;
        align-items: center;
      }

      .search-box {
        display: flex;
        align-items: center;
        background: white;
        border: 2px solid #e0e0e0;
        border-radius: 25px;
        padding: 8px 20px;
        transition: all 0.3s ease;
      }

      .search-box:focus-within {
        border-color: #8360c3;
        box-shadow: 0 4px 15px rgba(131, 96, 195, 0.2);
      }

      .search-box i {
        color: #999;
        margin-right: 10px;
      }

      .search-box input {
        border: none;
        outline: none;
        font-size: 14px;
        width: 250px;
      }

      .export-buttons {
        display: flex;
        gap: 10px;
      }

      .export-btn {
        background: linear-gradient(135deg, #8360c3 0%, #2ebf91 100%);
        color: white;
        border: none;
        padding: 10px 20px;
        border-radius: 25px;
        font-size: 14px;
        cursor: pointer;
        transition: all 0.3s ease;
        display: flex;
        align-items: center;
        gap: 8px;
        font-weight: 500;
      }

      .export-btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 8px 20px rgba(131, 96, 195, 0.3);
      }

      .activity-selector {
        background: rgba(255, 255, 255, 0.95);
        border-radius: 15px;
        padding: 25px;
        margin-bottom: 25px;
        box-shadow: 0 6px 20px rgba(0, 0, 0, 0.08);
      }

      .selector-label {
        font-size: 16px;
        color: #333;
        font-weight: 600;
        margin-bottom: 15px;
        display: flex;
        align-items: center;
        gap: 10px;
      }

      .selector-label i {
        color: #8360c3;
      }

      .activity-select {
        width: 100%;
        padding: 12px 20px;
        border: 2px solid #e0e0e0;
        border-radius: 10px;
        font-size: 15px;
        background: white;
        cursor: pointer;
        transition: all 0.3s ease;
        outline: none;
      }

      .activity-select:focus {
        border-color: #8360c3;
        box-shadow: 0 4px 15px rgba(131, 96, 195, 0.2);
      }

      .stats-row {
        display: grid;
        grid-template-columns: repeat(4, 1fr);
        gap: 20px;
        margin-bottom: 25px;
      }

      .stat-card {
        background: rgba(255, 255, 255, 0.95);
        border-radius: 15px;
        padding: 20px;
        box-shadow: 0 6px 20px rgba(0, 0, 0, 0.08);
        text-align: center;
        position: relative;
        overflow: hidden;
        transition: all 0.3s ease;
      }

      .stat-card:hover {
        transform: translateY(-3px);
        box-shadow: 0 10px 25px rgba(0, 0, 0, 0.12);
      }

      .stat-card::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 3px;
        background: linear-gradient(90deg, #8360c3 0%, #2ebf91 100%);
      }

      .stat-card i {
        font-size: 28px;
        background: linear-gradient(135deg, #8360c3 0%, #2ebf91 100%);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        margin-bottom: 10px;
      }

      .stat-card h3 {
        font-size: 32px;
        color: #333;
        margin-bottom: 5px;
        font-weight: 700;
      }

      .stat-card p {
        color: #666;
        font-size: 13px;
        font-weight: 500;
      }

      .table-section {
        background: rgba(255, 255, 255, 0.95);
        border-radius: 15px;
        padding: 25px;
        box-shadow: 0 6px 20px rgba(0, 0, 0, 0.08);
      }

      .table-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 20px;
      }

      .table-header h2 {
        font-size: 18px;
        color: #333;
        font-weight: 600;
        display: flex;
        align-items: center;
        gap: 10px;
      }

      .table-header h2 i {
        color: #8360c3;
      }

      .filter-group {
        display: flex;
        gap: 10px;
      }

      .filter-btn {
        padding: 8px 15px;
        border: 2px solid #e0e0e0;
        background: white;
        border-radius: 20px;
        font-size: 13px;
        cursor: pointer;
        transition: all 0.3s ease;
        color: #666;
      }

      .filter-btn:hover,
      .filter-btn.active {
        border-color: #8360c3;
        background: linear-gradient(135deg, #8360c3 0%, #2ebf91 100%);
        color: white;
      }

      .registrants-table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 15px;
      }

      .registrants-table thead {
        background: linear-gradient(135deg, #8360c3 0%, #2ebf91 100%);
      }

      .registrants-table th {
        padding: 15px;
        text-align: left;
        color: white;
        font-weight: 600;
        font-size: 14px;
        white-space: nowrap;
      }

      .registrants-table td {
        padding: 15px;
        border-bottom: 1px solid #f0f0f0;
        color: #333;
        font-size: 14px;
      }

      .registrants-table tbody tr {
        transition: all 0.2s ease;
      }

      .registrants-table tbody tr:hover {
        background: rgba(131, 96, 195, 0.05);
      }

      .status-badge {
        padding: 5px 12px;
        border-radius: 15px;
        font-size: 12px;
        font-weight: 600;
        display: inline-block;
      }

      .status-confirmed {
        background: rgba(46, 204, 113, 0.2);
        color: #27ae60;
      }

      .status-pending {
        background: rgba(243, 156, 18, 0.2);
        color: #f39c12;
      }

      .status-cancelled {
        background: rgba(231, 76, 60, 0.2);
        color: #e74c3c;
      }

      .action-buttons {
        display: flex;
        gap: 8px;
      }

      .action-btn {
        width: 32px;
        height: 32px;
        border-radius: 8px;
        border: none;
        background: #e8e8e8;
        color: #666;
        cursor: pointer;
        transition: all 0.2s ease;
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .action-btn:hover {
        background: #8360c3;
        color: white;
        transform: scale(1.1);
      }

      .sidebar::-webkit-scrollbar {
        width: 6px;
      }

      .sidebar::-webkit-scrollbar-track {
        background: rgba(0, 0, 0, 0.05);
      }

      .sidebar::-webkit-scrollbar-thumb {
        background: linear-gradient(135deg, #8360c3 0%, #2ebf91 100%);
        border-radius: 4px;
      }

      @media (max-width: 1200px) {
        .stats-row {
          grid-template-columns: repeat(2, 1fr);
        }
      }

      @media (max-width: 768px) {
        .main {
          flex-direction: column;
        }
        .sidebar {
          width: 100%;
          max-width: none;
        }
        .stats-row {
          grid-template-columns: 1fr 1fr;
        }
        .search-export {
          flex-direction: column;
          width: 100%;
        }
        .search-box {
          width: 100%;
        }
        .search-box input {
          width: 100%;
        }
        .export-buttons {
          flex-direction: column;
          width: 100%;
        }
        .export-btn {
          width: 100%;
          justify-content: center;
        }
      }

      /* ==========================================
         模態窗口樣式
         ========================================== */
      .modal-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.5);
        display: none;
        justify-content: center;
        align-items: center;
        z-index: 1000;
        animation: fadeIn 0.3s ease;
      }

      .modal-overlay.show {
        display: flex;
      }

      .modal {
        background: white;
        border-radius: 15px;
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        max-width: 600px;
        width: 90%;
        max-height: 90vh;
        overflow-y: auto;
        animation: slideUp 0.3s ease;
      }

      .modal-header {
        padding: 25px 30px;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        border-radius: 15px 15px 0 0;
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      .modal-header h2 {
        font-size: 20px;
        font-weight: 600;
        margin: 0;
      }

      .modal-close {
        background: none;
        border: none;
        color: white;
        font-size: 24px;
        cursor: pointer;
        padding: 5px 10px;
        transition: all 0.3s ease;
        border-radius: 50%;
      }

      .modal-close:hover {
        background: rgba(255, 255, 255, 0.2);
        transform: rotate(90deg);
      }

      .modal-body {
        padding: 30px;
      }

      .form-group {
        margin-bottom: 20px;
      }

      .form-group label {
        display: block;
        margin-bottom: 8px;
        font-weight: 600;
        color: #333;
        font-size: 14px;
      }

      .form-group input,
      .form-group select,
      .form-group textarea {
        width: 100%;
        padding: 12px 15px;
        border: 2px solid #e0e0e0;
        border-radius: 8px;
        font-size: 14px;
        transition: all 0.3s ease;
        font-family: inherit;
      }

      .form-group input:focus,
      .form-group select:focus,
      .form-group textarea:focus {
        outline: none;
        border-color: #667eea;
        box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
      }

      .modal-footer {
        padding: 20px 30px;
        background: #f8f9fa;
        border-radius: 0 0 15px 15px;
        display: flex;
        justify-content: flex-end;
        gap: 10px;
      }

      .btn {
        padding: 12px 25px;
        border: none;
        border-radius: 8px;
        font-size: 14px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
      }

      .btn-cancel {
        background: #6c757d;
        color: white;
      }

      .btn-cancel:hover {
        background: #5a6268;
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(108, 117, 125, 0.3);
      }

      .btn-submit {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
      }

      .btn-submit:hover {
        transform: translateY(-2px);
        box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
      }

      @keyframes fadeIn {
        from { opacity: 0; }
        to { opacity: 1; }
      }

      @keyframes slideUp {
        from {
          transform: translateY(50px);
          opacity: 0;
        }
        to {
          transform: translateY(0);
          opacity: 1;
        }
      }
    </style>
  </head>
  <body class="sci-page">
    <div class="header">
      <div
        class="header-left"
        onclick="location.href='science_club_activity_calendar.html';"
      >
        <img src="image/logo1.gif" alt="Logo" class="logo" />
      </div>
      <div class="header-right">
        <div class="icon-wrapper">
          <div class="icon" id="notificationBell">
            <i class="fas fa-bell"></i>
          </div>
          <div class="notification-badge" id="notificationBadge">0</div>
        </div>
        <div class="notification-panel" id="notificationPanel">
          <div class="notification-header">
            <h3><i class="fas fa-bell"></i> 通知中心</h3>
            <button class="mark-all-read">
              <i class="fas fa-check-double"></i> 全部已讀
            </button>
          </div>
          <div class="notification-list" id="notificationList">
            <div class="empty-notification">
              <i class="fas fa-inbox"></i>
              <p>沒有通知</p>
            </div>
          </div>
        </div>
        <div class="avatar" id="avatar">
          <i class="fas fa-user"></i>
        </div>
        <div class="dropdown" id="dropdown">
          <a href="login_teacher.html">
            <i class="fas fa-sign-out-alt"></i>
            登出
          </a>
        </div>
      </div>
    </div>

    <div class="main">
      <div class="sidebar">
        <div class="menu">
          <div class="menu-item">
            <a href="science_club_activity_calendar.html" class="menu-link">
              <i class="fas fa-calendar"></i>
              行事曆
            </a>
          </div>

          <div class="menu-item">
            <a href="science_club_event_album.html" class="menu-link">
              <i class="fas fa-image"></i>
              活動相簿
            </a>
          </div>

          <div class="menu-item">
            <div class="menu-link" onclick="toggleMenu(this); return false;">
              <i class="fas fa-bullhorn"></i>
              發佈公告/活動/表單
              <i class="fas fa-chevron-down menu-arrow"></i>
            </div>
            <div class="submenu">
              <div class="submenu-item">
                <a
                  href="science_club_publish_announcement.html"
                  class="submenu-link"
                >
                  <i class="fas fa-bullhorn"></i>
                  發佈公告
                </a>
              </div>
              <div class="submenu-item">
                <a
                  href="science_club_activity_publish.html"
                  class="submenu-link"
                >
                  <i class="fas fa-plus-circle"></i>
                  發佈比賽及活動
                </a>
              </div>
              <div class="submenu-item">
                <a href="science_club_table_publish.html" class="submenu-link">
                  <i class="fas fa-comment-alt"></i>
                  發佈活動反饋表單
                </a>
              </div>
            </div>
          </div>

          <div class="menu-item">
            <a href="science_club_name_manage.html" class="menu-link active">
              <i class="fas fa-user-edit"></i>
              報名人員名單管理
            </a>
          </div>

          <div class="menu-item">
            <a href="science_club_statistics.html" class="menu-link">
              <i class="fas fa-trophy"></i>
              統計比賽名次
            </a>
          </div>

          <div class="menu-item">
            <a href="science_club_upload_files.html" class="menu-link">
              <i class="fas fa-upload"></i>
              開放上傳檔案
            </a>
          </div>

          <div class="menu-item">
            <a href="science_club_request_review.html" class="menu-link">
              <i class="fas fa-file-signature"></i>
              請假申請
            </a>
          </div>

          <div class="menu-item">
            <a href="science_club_meeting_records.html" class="menu-link">
              <i class="fas fa-clipboard"></i>
              開會紀錄
            </a>
          </div>

          <div class="menu-item">
            <a href="science_club_image_recognition.html" class="menu-link">
              <i class="fas fa-eye"></i>
              圖片識別
            </a>
          </div>
        </div>
      </div>

      <div class="content">
        <div class="page-header">
          <div class="page-title">
            <i class="fas fa-users"></i>
            <h1>報名人員名單管理</h1>
          </div>
          <div class="search-export">
            <div class="search-box">
              <i class="fas fa-search"></i>
              <input
                type="text"
                placeholder="搜尋姓名、學號、班級..."
                id="searchInput"
              />
            </div>
            <div class="export-buttons">
              <button class="export-btn" onclick="exportToExcel()">
                <i class="fas fa-file-excel"></i>
                匯出Excel
              </button>
              <button class="export-btn" onclick="exportToWord()">
                <i class="fas fa-file-word"></i>
                匯出簽到表
              </button>
            </div>
          </div>
        </div>

        <div class="activity-selector">
          <div class="selector-label">
            <i class="fas fa-calendar-check"></i>
            選擇活動
          </div>
          <select
            class="activity-select"
            id="activitySelect"
            onchange="loadRegistrants()"
          >
            <option value="">請選擇要查看的活動</option>
            <!-- 已發佈的活動將由 JavaScript 動態載入 -->
          </select>
        </div>

        <div class="table-section">
          <div class="table-header">
            <h2>
              <i class="fas fa-list"></i>
              報名名單
            </h2>
            <div class="filter-group">
              <button class="filter-btn active" onclick="filterStatus('all')">
                全部
              </button>
              <button class="filter-btn" onclick="filterStatus('confirmed')">
                已確認
              </button>
              <button class="filter-btn" onclick="filterStatus('cancelled')">
                已取消
              </button>
            </div>
          </div>
          <table class="registrants-table">
            <thead>
              <tr>
                <th>序號</th>
                <th>班級</th>
                <th>學號</th>
                <th>姓名</th>
                <th>報名時間</th>
                <th>狀態</th>
                <th>操作</th>
              </tr>
            </thead>
            <tbody id="registrantsTableBody">
              
            </tbody>
          </table>
        </div>
      </div>
    </div>

    <!-- 編輯報名資料模態窗口 -->
    <div class="modal-overlay" id="editModal">
      <div class="modal" style="max-width: 500px;">
        <div class="modal-header">
          <h2>編輯報名資料</h2>
          <button class="modal-close" onclick="closeEditModal()">
            <i class="fas fa-times"></i>
          </button>
        </div>
        <div class="modal-body">
          <form id="editForm" onsubmit="event.preventDefault(); saveEdit();">
            <div class="form-group">
              <label for="editStudentNumber">學號</label>
              <input
                type="text"
                id="editStudentNumber"
                required
                placeholder="例如：110534109"
              />
            </div>
            <div class="form-group">
              <label for="editStudentName">姓名</label>
              <input
                type="text"
                id="editStudentName"
                required
                placeholder="例如：王小明"
              />
            </div>
            <div class="form-group">
              <label for="editStudentClass">班級</label>
              <input
                type="text"
                id="editStudentClass"
                required
                placeholder="例如：資五忠"
              />
            </div>
            <div class="form-group">
              <label for="editStatus">狀態</label>
              <select id="editStatus" required>
                <option value="registered">已確認</option>
                <option value="cancelled">已取消</option>
                <option value="attended">已出席</option>
                <option value="absent">未出席</option>
              </select>
            </div>
          </form>
        </div>
        <div class="modal-footer">
          <button class="btn btn-cancel" onclick="closeEditModal()">取消</button>
          <button class="btn btn-submit" type="submit" form="editForm">
            儲存修改
          </button>
        </div>
      </div>
    </div>

    <script>
      // ==========================================
      // API 配置
      // ==========================================
      const API_URL = 'api.php';
      
      // 全局變量
      let currentActivityId = null;
      let allRegistrations = [];
      let currentEditingId = null;

      // ==========================================
      // 初始化 - 從 API 載入數據
      // ==========================================
      document.addEventListener('DOMContentLoaded', async function() {
        await loadPublishedActivities();
        initializeEventListeners();
      });

      // ==========================================
      // 載入已發佈的活動列表
      // ==========================================
      async function loadPublishedActivities() {
        try {
          const response = await fetch(`${API_URL}?action=get_activities`);
          const result = await response.json();
          
          if (result.success) {
            const select = document.getElementById('activitySelect');
            select.innerHTML = '<option value="">請選擇要查看的活動</option>';
            
            // 只顯示已發佈的活動
            // const publishedActivities = result.data.filter(activity => activity.is_published == 1);
            const publishedActivities = result.data.filter(activity => activity.status === "published");
            
            publishedActivities.forEach(activity => {
              const option = document.createElement('option');
              option.value = activity.activity_id;
              option.textContent = `${activity.activity_name} (${activity.start_date})`;
              select.appendChild(option);
            });
          } else {
            showNotification('載入活動列表失敗: ' + result.message, 'error');
          }
        } catch (error) {
          console.error('載入活動列表失敗:', error);
          showNotification('載入活動列表失敗，請稍後再試', 'error');
        }
      }

      // ==========================================
      // 載入報名名單
      // ==========================================
      async function loadRegistrants() {
        const select = document.getElementById("activitySelect");
        const selectedValue = select.value;
        const tbody = document.getElementById("registrantsTableBody");

        if (!selectedValue) {
          tbody.innerHTML = '<tr><td colspan="7" style="text-align: center; padding: 40px; color: #999;">請選擇要查看的活動</td></tr>';
          return;
        }

        currentActivityId = selectedValue;

        try {
          const response = await fetch(`${API_URL}?action=get_registrations&activity_id=${selectedValue}`);
          const result = await response.json();
          
          if (result.success) {
            allRegistrations = result.data;
            renderRegistrants(allRegistrations);
          } else {
            showNotification('載入報名名單失敗: ' + result.message, 'error');
            tbody.innerHTML = '<tr><td colspan="7" style="text-align: center; padding: 40px; color: #999;">載入失敗</td></tr>';
          }
        } catch (error) {
          console.error('載入報名名單失敗:', error);
          showNotification('載入報名名單失敗，請稍後再試', 'error');
          tbody.innerHTML = '<tr><td colspan="7" style="text-align: center; padding: 40px; color: #999;">載入失敗</td></tr>';
        }
      }

      // ==========================================
      // 渲染報名名單
      // ==========================================
      function renderRegistrants(registrations) {
        const tbody = document.getElementById("registrantsTableBody");
        
        if (registrations.length === 0) {
          tbody.innerHTML = '<tr><td colspan="7" style="text-align: center; padding: 40px; color: #999;">目前沒有報名資料</td></tr>';
          return;
        }

        tbody.innerHTML = '';
        registrations.forEach((reg, index) => {
          const row = document.createElement('tr');
          
          // 判斷狀態
          let statusClass = 'status-confirmed';
          let statusText = '已確認';
          
          if (reg.status === 'cancelled') {
            statusClass = 'status-cancelled';
            statusText = '已取消';
          } else if (reg.status === 'registered') {
            statusClass = 'status-confirmed';
            statusText = '已確認';
          } else if (reg.status === 'attended') {
            statusClass = 'status-confirmed';
            statusText = '已出席';
          } else if (reg.status === 'absent') {
            statusClass = 'status-cancelled';
            statusText = '未出席';
          }
          
          row.innerHTML = `
            <td>${index + 1}</td>
            <td>${reg.student_class}</td>
            <td>${reg.student_number}</td>
            <td>${reg.student_name}</td>
            <td>${reg.registration_time}</td>
            <td>
              <span class="status-badge ${statusClass}">${statusText}</span>
            </td>
            <td>
              <div class="action-buttons">
                <button class="action-btn" title="編輯" onclick="openEditModal(${reg.registration_id})">
                  <i class="fas fa-edit"></i>
                </button>
                <button class="action-btn" title="刪除" onclick="deleteRegistration(${reg.registration_id})">
                  <i class="fas fa-trash"></i>
                </button>
              </div>
            </td>
          `;
          
          tbody.appendChild(row);
        });
      }

      function toggleMenu(element) {
        const menuItem = element.parentElement;
        const submenu = menuItem.querySelector(".submenu");
        const isExpanded = menuItem.classList.contains("expanded");

        document.querySelectorAll(".menu-item").forEach((item) => {
          if (item !== menuItem) {
            item.classList.remove("expanded");
            const otherSubmenu = item.querySelector(".submenu");
            if (otherSubmenu) {
              otherSubmenu.classList.remove("show");
            }
          }
        });

        if (isExpanded) {
          menuItem.classList.remove("expanded");
          submenu.classList.remove("show");
        } else {
          menuItem.classList.add("expanded");
          submenu.classList.add("show");
        }
      }

      // ==========================================
      // 篩選功能
      // ==========================================
      function filterStatus(status) {
        document.querySelectorAll(".filter-btn").forEach((btn) => {
          btn.classList.remove("active");
        });
        event.target.classList.add("active");

        if (status === "all") {
          renderRegistrants(allRegistrations);
        } else {
          const filtered = allRegistrations.filter(reg => {
            if (status === 'confirmed') {
              return reg.status === 'registered' || reg.status === 'attended';
            } else if (status === 'cancelled') {
              return reg.status === 'cancelled' || reg.status === 'absent';
            }
            return true;
          });
          renderRegistrants(filtered);
        }
      }

      // ==========================================
      // 編輯報名
      // ==========================================
      function openEditModal(registrationId) {
        const reg = allRegistrations.find(r => r.registration_id == registrationId);
        if (!reg) return;

        currentEditingId = registrationId;
        
        // 填充表單
        document.getElementById('editStudentNumber').value = reg.student_number;
        document.getElementById('editStudentName').value = reg.student_name;
        document.getElementById('editStudentClass').value = reg.student_class;
        document.getElementById('editStatus').value = reg.status;
        
        // 顯示模態窗口
        document.getElementById('editModal').classList.add('show');
      }

      function closeEditModal() {
        document.getElementById('editModal').classList.remove('show');
        currentEditingId = null;
      }

      async function saveEdit() {
        if (!currentEditingId) return;

        const studentNumber = document.getElementById('editStudentNumber').value.trim();
        const studentName = document.getElementById('editStudentName').value.trim();
        const studentClass = document.getElementById('editStudentClass').value.trim();
        const status = document.getElementById('editStatus').value;

        if (!studentNumber || !studentName || !studentClass) {
          showNotification('請填寫所有必填欄位', 'error');
          return;
        }

        const formData = new FormData();
        formData.append('action', 'update_registration');
        formData.append('registration_id', currentEditingId);
        formData.append('student_number', studentNumber);
        formData.append('student_name', studentName);
        formData.append('student_class', studentClass);
        formData.append('status', status);

        try {
          const response = await fetch(API_URL, {
            method: 'POST',
            body: formData
          });
          
          const result = await response.json();
          
          if (result.success) {
            showNotification('✅ 修改成功！', 'success');
            closeEditModal();
            await loadRegistrants(); // 重新載入列表
          } else {
            showNotification('修改失敗: ' + result.message, 'error');
          }
        } catch (error) {
          console.error('修改報名失敗:', error);
          showNotification('修改失敗，請稍後再試', 'error');
        }
      }

      // ==========================================
      // 刪除報名
      // ==========================================
      async function deleteRegistration(registrationId) {
        const reg = allRegistrations.find(r => r.registration_id == registrationId);
        if (!reg) return;

        if (!confirm(`確定要刪除 ${reg.student_name} (${reg.student_number}) 的報名資料嗎？`)) {
          return;
        }

        const formData = new FormData();
        formData.append('action', 'delete_registration');
        formData.append('registration_id', registrationId);

        try {
          const response = await fetch(API_URL, {
            method: 'POST',
            body: formData
          });
          
          const result = await response.json();
          
          if (result.success) {
            showNotification('✅ 刪除成功！', 'success');
            await loadRegistrants(); // 重新載入列表
          } else {
            showNotification('刪除失敗: ' + result.message, 'error');
          }
        } catch (error) {
          console.error('刪除報名失敗:', error);
          showNotification('刪除失敗，請稍後再試', 'error');
        }
      }

      // ==========================================
      // 初始化事件監聽器
      // ==========================================
      function initializeEventListeners() {
        // 搜尋功能
        const searchInput = document.getElementById('searchInput');
        if (searchInput) {
          searchInput.addEventListener("input", function (e) {
            const searchTerm = e.target.value.toLowerCase();
            const rows = document.querySelectorAll(".registrants-table tbody tr");

            rows.forEach((row) => {
              const text = row.textContent.toLowerCase();
              row.style.display = text.includes(searchTerm) ? "" : "none";
            });
          });
        }

        // 關閉模態窗口事件
        document.addEventListener('click', function(e) {
          if (e.target.classList.contains('modal-overlay')) {
            closeEditModal();
          }
        });
      }

      // 匯出Excel檔案
      function exportToExcel() {
        const select = document.getElementById("activitySelect");
        const selectedActivity = select.options[select.selectedIndex].text;
        if (!select.value) {
          showNotification("請先選擇活動!", 'error');
          return;
        }

        // 取得表格資料
        const table = document.querySelector(".registrants-table");
        const rows = Array.from(table.querySelectorAll("tbody tr")).filter(
          (row) => row.style.display !== "none" && row.cells.length > 1
        );

        if (rows.length === 0) {
          showNotification("沒有可匯出的資料!", 'error');
          return;
        }

        // 建立Excel XML格式內容
        let excelContent = `<?xml version="1.0"?>
      <Workbook xmlns="urn:schemas-microsoft-com:office:spreadsheet"
       xmlns:o="urn:schemas-microsoft-com:office:office"
       xmlns:x="urn:schemas-microsoft-com:office:excel"
       xmlns:ss="urn:schemas-microsoft-com:office:spreadsheet"
       xmlns:html="http://www.w3.org/TR/REC-html40">
       <DocumentProperties xmlns="urn:schemas-microsoft-com:office:office">
        <Title>${selectedActivity} - 報名名單</Title>
       </DocumentProperties>
       <Styles>
        <Style ss:ID="Header">
         <Font ss:Bold="1"/>
         <Interior ss:Color="#CCCCCC" ss:Pattern="Solid"/>
        </Style>
       </Styles>
       <Worksheet ss:Name="報名名單">
        <Table>
         <Row>
          <Cell ss:StyleID="Header"><Data ss:Type="String">序號</Data></Cell>
          <Cell ss:StyleID="Header"><Data ss:Type="String">班級</Data></Cell>
          <Cell ss:StyleID="Header"><Data ss:Type="String">學號</Data></Cell>
          <Cell ss:StyleID="Header"><Data ss:Type="String">姓名</Data></Cell>
          <Cell ss:StyleID="Header"><Data ss:Type="String">報名時間</Data></Cell>
          <Cell ss:StyleID="Header"><Data ss:Type="String">狀態</Data></Cell>
         </Row>`;

        rows.forEach((row) => {
          const cells = row.querySelectorAll("td");
          excelContent += `
         <Row>
          <Cell><Data ss:Type="String">${cells[0].textContent.trim()}</Data></Cell>
          <Cell><Data ss:Type="String">${cells[1].textContent.trim()}</Data></Cell>
          <Cell><Data ss:Type="String">${cells[2].textContent.trim()}</Data></Cell>
          <Cell><Data ss:Type="String">${cells[3].textContent.trim()}</Data></Cell>
          <Cell><Data ss:Type="String">${cells[4].textContent.trim()}</Data></Cell>
          <Cell><Data ss:Type="String">${cells[5]
            .querySelector(".status-badge")
            .textContent.trim()}</Data></Cell>
         </Row>`;
        });

        excelContent += `
        </Table>
       </Worksheet>
      </Workbook>`;

        // 下載Excel檔案
        const blob = new Blob([excelContent], {
          type: "application/vnd.ms-excel",
        });
        const link = document.createElement("a");
        const url = URL.createObjectURL(blob);
        link.setAttribute("href", url);
        link.setAttribute("download", `${selectedActivity}_報名名單.xls`);
        link.style.visibility = "hidden";
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);

        alert(`已匯出「${selectedActivity}」的Excel報名名單!`);
      }

      // 匯出Word簽到表
      function exportToWord() {
        const select = document.getElementById("activitySelect");
        const selectedActivity = select.options[select.selectedIndex].text;
        if (!select.value) {
          showNotification("請先選擇活動!", 'error');
          return;
        }

        // 取得表格資料
        const table = document.querySelector(".registrants-table");
        const rows = Array.from(table.querySelectorAll("tbody tr")).filter(
          (row) => row.style.display !== "none" && row.cells.length > 1
        );

        if (rows.length === 0) {
          showNotification("沒有可匯出的資料!", 'error');
          return;
        }

        // 建立HTML內容
        let htmlContent = `
                <!DOCTYPE html>
                <html>
                <head>
                  <meta charset="utf-8">
                  <title>${selectedActivity} - 簽到表</title>
                  <style>
                    body { font-family: "Microsoft JhengHei", Arial, sans-serif; margin: 20px; }
                    h1 { text-align: center; color: #333; margin-bottom: 30px; }
                    table { width: 100%; border-collapse: collapse; margin-top: 20px; }
                    th, td { border: 1px solid #333; padding: 8px; text-align: center; }
                    th { background-color: #f0f0f0; font-weight: bold; }
                    .signature { height: 40px; }
                  </style>
                </head>
                <body>
                  <h1>${selectedActivity} - 簽到表</h1>
                  <table>
                    <thead>
                      <tr>
                        <th>序號</th>
                        <th>班級</th>
                        <th>學號</th>
                        <th>姓名</th>
                        <th>簽到</th>
                      </tr>
                    </thead>
                    <tbody>
              `;

        rows.forEach((row) => {
          const cells = row.querySelectorAll("td");
          htmlContent += `
                  <tr>
                    <td>${cells[0].textContent.trim()}</td>
                    <td>${cells[1].textContent.trim()}</td>
                    <td>${cells[2].textContent.trim()}</td>
                    <td>${cells[3].textContent.trim()}</td>
                    <td class="signature"></td>
                  </tr>
                `;
        });

        htmlContent += `
                    </tbody>
                  </table>
                </body>
                </html>
              `;

        // 下載檔案
        const blob = new Blob([htmlContent], { type: "application/msword" });
        const link = document.createElement("a");
        const url = URL.createObjectURL(blob);
        link.setAttribute("href", url);
        link.setAttribute("download", `${selectedActivity}_簽到表.doc`);
        link.style.visibility = "hidden";
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);

        alert(`已匯出「${selectedActivity}」的Word簽到表!`);
      }

      // 搜尋功能
      document
        .getElementById("searchInput")
        .addEventListener("input", function (e) {
          const searchTerm = e.target.value.toLowerCase();
          const rows = document.querySelectorAll(".registrants-table tbody tr");

          rows.forEach((row) => {
            const text = row.textContent.toLowerCase();
            row.style.display = text.includes(searchTerm) ? "" : "none";
          });
        });

      // 操作按鈕事件
      document.querySelectorAll(".action-btn").forEach((btn) => {
        btn.addEventListener("click", function (e) {
          e.stopPropagation();
          const action = this.title;
          const row = this.closest("tr");
          const name = row.cells[3].textContent; // 姓名在第4欄

          if (action === "編輯") {
            alert("編輯 " + name + " 的資料");
          } else if (action === "刪除") {
            if (confirm("確定要刪除 " + name + " 的報名資料嗎?")) {
              alert("已刪除 " + name + " 的報名資料");
              row.remove();
            }
          }
        });
      });

      // ==========================================
      // 通知提示函數
      // ==========================================
      function showNotification(message, type = 'info') {
        const notification = document.createElement('div');
        notification.style.cssText = `
          position: fixed;
          top: 20px;
          right: 20px;
          padding: 15px 25px;
          background: ${
            type === 'success' ? 'linear-gradient(135deg, #28a745 0%, #20c997 100%)' :
            type === 'error' ? 'linear-gradient(135deg, #dc3545 0%, #e83e8c 100%)' :
            'linear-gradient(135deg, #17a2b8 0%, #6f42c1 100%)'
          };
          color: white;
          border-radius: 10px;
          box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
          z-index: 10000;
          font-weight: 500;
          animation: slideIn 0.3s ease;
          cursor: pointer;
        `;
        notification.textContent = message;

        notification.addEventListener('click', () => {
          notification.style.animation = 'slideOut 0.3s ease';
          setTimeout(() => notification.remove(), 300);
        });

        document.body.appendChild(notification);

        setTimeout(() => {
          if (notification.parentNode) {
            notification.style.animation = 'slideOut 0.3s ease';
            setTimeout(() => notification.remove(), 300);
          }
        }, 3000);
      }

      // 添加動畫樣式
      if (!document.querySelector('#notificationStyles')) {
        const style = document.createElement('style');
        style.id = 'notificationStyles';
        style.textContent = `
          @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
          }
          @keyframes slideOut {
            from { transform: translateX(0); opacity: 1; }
            to { transform: translateX(100%); opacity: 0; }
          }
        `;
        document.head.appendChild(style);
      }
    </script>
  </body>
</html>