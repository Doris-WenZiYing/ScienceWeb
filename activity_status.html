<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <title>查看活動情況 - 老師系統</title>
  <!-- FontAwesome CDN -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    html, body {
      height: 100%;
      font-family: 'Microsoft JhengHei', 'Arial', sans-serif;
      background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
    }

    .header {
      height: 70px;
      background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%);
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0 30px;
      box-shadow: 0 2px 20px rgba(0,0,0,0.1);
      position: relative;
      z-index: 100;
    }

    .header::before {
      content: '';
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      height: 3px;
      background: linear-gradient(90deg, #11998e 0%, #38ef7d 100%);
    }

    .header img.logo {
      height: 50px;
      filter: drop-shadow(0 2px 8px rgba(0,0,0,0.1));
      transition: transform 0.3s ease;
    }

    .header img.logo:hover {
      transform: scale(1.05);
    }

    .header-right {
      display: flex;
      align-items: center;
      gap: 25px;
      position: relative;
    }

    .icon {
      position: relative;
      padding: 10px;
      border-radius: 50%;
      background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
      transition: all 0.3s ease;
      cursor: pointer;
    }

    .icon:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 25px rgba(17, 153, 142, 0.4);
    }

    .icon i {
      font-size: 18px;
      color: white;
    }

    .icon::after {
      content: '3';
      position: absolute;
      top: -2px;
      right: -2px;
      background: #ff4757;
      color: white;
      border-radius: 50%;
      width: 18px;
      height: 18px;
      font-size: 11px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
    }

    .avatar {
      width: 45px;
      height: 45px;
      border-radius: 50%;
      background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.3s ease;
      border: 3px solid #fff;
      box-shadow: 0 4px 15px rgba(0,0,0,0.1);
    }

    .avatar:hover {
      transform: scale(1.1);
      box-shadow: 0 6px 20px rgba(17, 153, 142, 0.3);
    }

    .avatar i {
      font-size: 20px;
      color: white;
    }

    .dropdown {
      position: absolute;
      top: 65px;
      right: 0;
      background: white;
      border-radius: 12px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.2);
      display: none;
      min-width: 120px;
      z-index: 1000;
      overflow: hidden;
      animation: dropdownFade 0.3s ease;
    }

    @keyframes dropdownFade {
      from {
        opacity: 0;
        transform: translateY(-10px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .dropdown a {
      display: flex;
      align-items: center;
      padding: 12px 16px;
      text-decoration: none;
      color: #333;
      font-size: 14px;
      transition: all 0.2s ease;
    }

    .dropdown a:hover {
      background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
      color: white;
    }

    .dropdown a i {
      margin-right: 8px;
      width: 16px;
    }

    .main {
      display: flex;
      height: calc(100% - 70px);
      gap: 0;
    }

    .sidebar {
      width: 250px;
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(10px);
      padding: 30px 0;
      display: flex;
      flex-direction: column;
      box-shadow: 2px 0 20px rgba(0,0,0,0.1);
      position: relative;
    }

    .sidebar::before {
      content: '';
      position: absolute;
      top: 0;
      right: 0;
      width: 4px;
      height: 100%;
      background: linear-gradient(180deg, #11998e 0%, #38ef7d 100%);
    }

    .menu a {
      display: flex;
      align-items: center;
      padding: 18px 30px;
      text-decoration: none;
      color: #555;
      font-size: 16px;
      transition: all 0.3s ease;
      border-left: 4px solid transparent;
      position: relative;
    }

    .menu a:hover, .menu a.active {
      color: #11998e;
      background: rgba(17, 153, 142, 0.1);
      border-left: 4px solid #11998e;
      transform: translateX(5px);
    }

    .menu a i {
      margin-right: 15px;
      width: 20px;
      font-size: 18px;
    }

    .content {
      flex: 1;
      padding: 40px;
      background: rgba(255, 255, 255, 0.1);
      backdrop-filter: blur(10px);
      display: flex;
      flex-direction: column;
      overflow-y: auto;
    }

    .activity-container {
      background: rgba(255, 255, 255, 0.9);
      border-radius: 20px;
      padding: 30px;
      backdrop-filter: blur(10px);
      box-shadow: 0 8px 25px rgba(0,0,0,0.1);
    }

    .activity-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 30px;
      flex-wrap: wrap;
      gap: 15px;
    }

    .activity-title {
      font-size: 28px;
      color: #333;
      font-weight: 300;
      display: flex;
      align-items: center;
    }

    .activity-title i {
      margin-right: 15px;
      color: #11998e;
      font-size: 32px;
    }

    .header-time {
      background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
      color: white;
      padding: 10px 20px;
      border-radius: 25px;
      font-size: 14px;
      font-weight: 500;
      display: flex;
      align-items: center;
      gap: 8px;
      box-shadow: 0 2px 10px rgba(17, 153, 142, 0.3);
    }

    .header-time i {
      font-size: 16px;
    }

    .filter-section {
      background: rgba(248, 249, 250, 0.8);
      border-radius: 15px;
      padding: 25px;
      margin-bottom: 30px;
      display: flex;
      flex-wrap: wrap;
      gap: 15px;
      align-items: center;
    }

    .search-input, .filter-select {
      padding: 12px 16px;
      border: 2px solid #e9ecef;
      border-radius: 10px;
      font-size: 14px;
      transition: all 0.3s ease;
      background: white;
    }

    .search-input {
      flex: 1;
      min-width: 250px;
    }

    .search-input:focus, .filter-select:focus {
      outline: none;
      border-color: #11998e;
      box-shadow: 0 0 0 3px rgba(17, 153, 142, 0.1);
    }

    .filter-select {
      min-width: 150px;
    }

    .btn {
      padding: 12px 24px;
      border: none;
      border-radius: 10px;
      cursor: pointer;
      font-size: 14px;
      font-weight: 500;
      transition: all 0.3s ease;
      display: inline-flex;
      align-items: center;
      gap: 8px;
    }

    .btn-primary {
      background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
      color: white;
      box-shadow: 0 4px 15px rgba(17, 153, 142, 0.3);
    }

    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 25px rgba(17, 153, 142, 0.4);
    }

    .btn-secondary {
      background: #6c757d;
      color: white;
    }

    .btn-secondary:hover {
      background: #5a6268;
      transform: translateY(-2px);
    }

    .stats-overview {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 20px;
      margin-bottom: 30px;
    }

    .stat-item {
      background: white;
      border-radius: 15px;
      padding: 25px;
      text-align: center;
      box-shadow: 0 4px 15px rgba(0,0,0,0.1);
      transition: all 0.3s ease;
    }

    .stat-item:hover {
      transform: translateY(-5px);
      box-shadow: 0 8px 25px rgba(0,0,0,0.15);
    }

    .stat-number {
      font-size: 36px;
      font-weight: bold;
      margin-bottom: 10px;
      background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }

    .stat-label {
      color: #666;
      font-size: 14px;
    }

    .activity-list {
      display: grid;
      gap: 20px;
    }

    .activity-card {
      background: white;
      border-radius: 15px;
      padding: 25px;
      box-shadow: 0 4px 15px rgba(0,0,0,0.1);
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
    }

    .activity-card::before {
      content: '';
      position: absolute;
      left: 0;
      top: 0;
      width: 5px;
      height: 100%;
      background: linear-gradient(180deg, #11998e 0%, #38ef7d 100%);
    }

    .activity-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 8px 25px rgba(0,0,0,0.15);
    }

    .card-header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      margin-bottom: 15px;
    }

    .card-title {
      font-size: 20px;
      font-weight: 600;
      color: #333;
      flex: 1;
      margin-right: 15px;
    }

    .status-badge {
      padding: 6px 15px;
      border-radius: 20px;
      font-size: 12px;
      font-weight: bold;
      text-transform: uppercase;
    }

    .status-ongoing {
      background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
      color: white;
    }

    .status-upcoming {
      background: linear-gradient(135deg, #ffc107 0%, #fd7e14 100%);
      color: white;
    }

    .status-completed {
      background: linear-gradient(135deg, #17a2b8 0%, #6f42c1 100%);
      color: white;
    }

    .status-cancelled {
      background: linear-gradient(135deg, #dc3545 0%, #e83e8c 100%);
      color: white;
    }

    .card-info {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      gap: 15px;
      margin-bottom: 20px;
    }

    .info-item {
      display: flex;
      align-items: center;
      font-size: 14px;
      color: #666;
    }

    .info-icon {
      margin-right: 8px;
      color: #11998e;
      width: 16px;
    }

    .card-description {
      color: #666;
      font-size: 14px;
      line-height: 1.5;
      margin-bottom: 20px;
    }

    .card-actions {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
    }

    .btn-sm {
      padding: 8px 16px;
      font-size: 12px;
    }

    .btn-info {
      background: linear-gradient(135deg, #17a2b8 0%, #20c997 100%);
      color: white;
    }

    .btn-warning {
      background: linear-gradient(135deg, #ffc107 0%, #fd7e14 100%);
      color: white;
    }

    .btn-danger {
      background: linear-gradient(135deg, #dc3545 0%, #e83e8c 100%);
      color: white;
    }

    .btn-sm:hover {
      transform: translateY(-1px);
      box-shadow: 0 4px 15px rgba(0,0,0,0.2);
    }

    @media (max-width: 768px) {
      .main {
        flex-direction: column;
      }
      
      .sidebar {
        width: 100%;
        height: auto;
      }
      
      .menu {
        display: flex;
        overflow-x: auto;
      }
      
      .menu a {
        white-space: nowrap;
        padding: 15px 20px;
      }

      .content {
        padding: 20px;
      }

      .filter-section {
        flex-direction: column;
        align-items: stretch;
      }

      .search-input {
        min-width: auto;
      }

      .card-info {
        grid-template-columns: 1fr;
      }

      .stats-overview {
        grid-template-columns: repeat(2, 1fr);
      }

      .activity-header {
        flex-direction: column;
        align-items: flex-start;
        gap: 15px;
      }

      .header-time {
        align-self: stretch;
        justify-content: center;
        font-size: 12px;
        padding: 8px 15px;
      }
    }

    ::-webkit-scrollbar {
      width: 8px;
    }

    ::-webkit-scrollbar-track {
      background: rgba(0,0,0,0.1);
    }

    ::-webkit-scrollbar-thumb {
      background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
      border-radius: 4px;
    }

    ::-webkit-scrollbar-thumb:hover {
      background: linear-gradient(135deg, #38ef7d 0%, #11998e 100%);
    }

    .modal {
      display: none;
      position: fixed;
      z-index: 1000;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0,0,0,0.5);
      backdrop-filter: blur(5px);
    }

    .modal-content {
      background-color: white;
      margin: 5% auto;
      padding: 30px;
      border-radius: 20px;
      width: 90%;
      max-width: 600px;
      box-shadow: 0 20px 40px rgba(0,0,0,0.3);
      animation: modalFade 0.3s ease;
    }

    @keyframes modalFade {
      from {
        opacity: 0;
        transform: translateY(-50px) scale(0.9);
      }
      to {
        opacity: 1;
        transform: translateY(0) scale(1);
      }
    }

    .close {
      color: #aaa;
      float: right;
      font-size: 28px;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .close:hover {
      color: #dc3545;
      transform: scale(1.1);
    }
  </style>
</head>
<body>
  <div class="header">
    <img src="image/logo1.gif" alt="Logo" class="logo">
    <div class="header-right">
      <div class="icon"><i class="fas fa-bell"></i></div>
      <div class="avatar" id="avatar">
        <i class="fas fa-user"></i>
      </div>
      <div class="dropdown" id="dropdown">
        <a href="login_teacher.html">
          <i class="fas fa-sign-out-alt"></i>
          登出
        </a>
      </div>
    </div>
  </div>

  <div class="main">
    <div class="sidebar">
      <div class="menu">
        <a href="teacher_dashboard.html">
          <i class="fas fa-home"></i>
          老師首頁
        </a>
        <a href="activity_status.html" class="active">
          <i class="fas fa-chart-bar"></i>
          查看活動情況
        </a>
        <a href="registration_statistics.html">
          <i class="fas fa-users"></i>
          報名數據統計
        </a>
        <a href="form_feedback.html">
          <i class="fas fa-comments"></i>
          學生表單反饋
        </a>
         <a href="Teacher_schedules_classes.html">
          <i class="fas fa-calendar-alt"></i>
          線上排班
        </a>
        <a href="askforleave.html">
          <i class="fas fa-clipboard-check"></i>
          請假審核
        </a>
        <a href="work_hours_attendance.html">
          <i class="fas fa-clock"></i>
          工作時數與出席記錄
        </a>
            </div>
    </div>
    
    <div class="content">
      <div class="activity-container">
        <div class="activity-header">
          <div class="activity-title">
            <i class="fas fa-chart-line"></i>
            活動情況總覽
          </div>
          <div class="header-time" id="currentTime">
            <i class="fas fa-clock"></i>
            <span id="timeText"></span>
          </div>
        </div>

        <div class="filter-section">
          <input type="text" class="search-input" placeholder="搜尋活動名稱..." id="searchInput">
          <select class="filter-select" id="statusFilter">
            <option value="">全部狀態</option>
            <option value="ongoing">進行中</option>
            <option value="upcoming">即將開始</option>
            <option value="completed">已完成</option>
            <option value="cancelled">已取消</option>
          </select>
          <select class="filter-select" id="categoryFilter">
            <option value="">全部類別</option>
            <option value="science">科學實驗</option>
            <option value="math">數學課程</option>
            <option value="english">英語學習</option>
            <option value="art">藝術創作</option>
          </select>
          <button class="btn btn-primary" onclick="filterActivities()">
            <i class="fas fa-search"></i>
            搜尋
          </button>
          <button class="btn btn-secondary" onclick="resetFilters()">
            <i class="fas fa-redo"></i>
            重設
          </button>
        </div>

        <div class="stats-overview">
          <div class="stat-item">
            <div class="stat-number" id="ongoingCount">8</div>
            <div class="stat-label">進行中活動</div>
          </div>
          <div class="stat-item">
            <div class="stat-number" id="upcomingCount">4</div>
            <div class="stat-label">即將開始</div>
          </div>
          <div class="stat-item">
            <div class="stat-number" id="completedCount">15</div>
            <div class="stat-label">已完成</div>
          </div>
          <div class="stat-item">
            <div class="stat-number" id="totalParticipants">156</div>
            <div class="stat-label">總參與人數</div>
          </div>
        </div>

        <div class="activity-list" id="activityList"></div>
      </div>
    </div>
  </div>

  <div id="activityModal" class="modal">
    <div class="modal-content">
      <span class="close" onclick="closeModal()">&times;</span>
      <div id="modalContent"></div>
    </div>
  </div>

  <script>
    const activitiesData = [
      {
        id: 1,
        title: '科學實驗探索營',
        status: 'ongoing',
        category: 'science',
        startDate: '2025-09-08',
        endDate: '2025-09-15',
        location: '實驗室A',
        participants: 25,
        maxParticipants: 30,
        instructor: '王老師',
        description: '透過有趣的科學實驗,讓學生深入了解化學和物理原理,培養科學思維和動手能力。'
      },
      {
        id: 2,
        title: '數學思維訓練班',
        status: 'upcoming',
        category: 'math',
        startDate: '2025-09-15',
        endDate: '2025-09-22',
        location: '教室B101',
        participants: 18,
        maxParticipants: 20,
        instructor: '李老師',
        description: '提升學生邏輯思維能力,通過趣味數學題目和遊戲,讓學習數學變得更加有趣。'
      },
      {
        id: 3,
        title: '英語口語提升班',
        status: 'ongoing',
        category: 'english',
        startDate: '2025-09-05',
        endDate: '2025-09-19',
        location: '語言教室C',
        participants: 22,
        maxParticipants: 25,
        instructor: '張老師',
        description: '專注於提升學生英語口語表達能力,通過情境對話和角色扮演練習。'
      },
      {
        id: 4,
        title: '創意美術工作坊',
        status: 'completed',
        category: 'art',
        startDate: '2025-08-20',
        endDate: '2025-08-27',
        location: '美術教室',
        participants: 20,
        maxParticipants: 20,
        instructor: '陳老師',
        description: '引導學生發揮創意,學習各種繪畫技巧和藝術表現形式。'
      },
      {
        id: 5,
        title: '程式設計入門',
        status: 'upcoming',
        category: 'science',
        startDate: '2025-09-20',
        endDate: '2025-09-30',
        location: '電腦教室',
        participants: 15,
        maxParticipants: 25,
        instructor: '劉老師',
        description: '教授基礎程式設計概念,讓學生體驗編程的樂趣。'
      },
      {
        id: 6,
        title: '音樂欣賞課程',
        status: 'cancelled',
        category: 'art',
        startDate: '2025-09-12',
        endDate: '2025-09-19',
        location: '音樂教室',
        participants: 0,
        maxParticipants: 30,
        instructor: '吳老師',
        description: '因設備故障暫時取消,將重新安排時間。'
      }
    ];

    let filteredActivities = [...activitiesData];

    const statusMap = {
      'ongoing': { text: '進行中', class: 'status-ongoing' },
      'upcoming': { text: '即將開始', class: 'status-upcoming' },
      'completed': { text: '已完成', class: 'status-completed' },
      'cancelled': { text: '已取消', class: 'status-cancelled' }
    };

    const categoryMap = {
      'science': '科學實驗',
      'math': '數學課程',
      'english': '英語學習',
      'art': '藝術創作'
    };

    window.addEventListener('load', () => {
      updateTime();
      setInterval(updateTime, 1000);
      renderActivities();
      updateStats();
      
      document.getElementById('searchInput').addEventListener('input', filterActivities);
      document.getElementById('statusFilter').addEventListener('change', filterActivities);
      document.getElementById('categoryFilter').addEventListener('change', filterActivities);
    });

    const avatar = document.getElementById('avatar');
    const dropdown = document.getElementById('dropdown');

    avatar.addEventListener('click', () => {
      dropdown.style.display = dropdown.style.display === 'block' ? 'none' : 'block';
    });

    window.addEventListener('click', function(e) {
      if (!avatar.contains(e.target) && !dropdown.contains(e.target)) {
        dropdown.style.display = 'none';
      }
    });

    function updateTime() {
      const now = new Date();
      const options = {
        year: 'numeric',
        month: '2-digit',
        day: '2-digit',
        hour: '2-digit',
        minute: '2-digit',
        second: '2-digit',
        weekday: 'long'
      };
      
      const timeString = now.toLocaleDateString('zh-TW', options);
      document.getElementById('timeText').textContent = timeString;
    }

    function renderActivities() {
      const activityList = document.getElementById('activityList');
      activityList.innerHTML = '';

      if (filteredActivities.length === 0) {
        activityList.innerHTML = `
          <div style="text-align: center; padding: 60px; color: #666;">
            <i class="fas fa-search" style="font-size: 48px; margin-bottom: 20px; opacity: 0.5;"></i>
            <p style="font-size: 18px;">沒有找到符合條件的活動</p>
          </div>
        `;
        return;
      }

      filteredActivities.forEach(activity => {
        const statusInfo = statusMap[activity.status];
        const participantPercentage = ((activity.participants / activity.maxParticipants) * 100).toFixed(1);
        
        const activityCard = document.createElement('div');
        activityCard.className = 'activity-card';
        activityCard.innerHTML = `
          <div class="card-header">
            <div class="card-title">${activity.title}</div>
            <div class="status-badge ${statusInfo.class}">${statusInfo.text}</div>
          </div>
          
          <div class="card-info">
            <div class="info-item">
              <i class="fas fa-calendar info-icon"></i>
              ${activity.startDate} ~ ${activity.endDate}
            </div>
            <div class="info-item">
              <i class="fas fa-map-marker-alt info-icon"></i>
              ${activity.location}
            </div>
            <div class="info-item">
              <i class="fas fa-users info-icon"></i>
              ${activity.participants}/${activity.maxParticipants} 人 (${participantPercentage}%)
            </div>
            <div class="info-item">
              <i class="fas fa-chalkboard-teacher info-icon"></i>
              ${activity.instructor}
            </div>
            <div class="info-item">
              <i class="fas fa-tag info-icon"></i>
              ${categoryMap[activity.category]}
            </div>
          </div>
          
          <div class="card-description">
            ${activity.description}
          </div>
          
          <div class="card-actions">
            <button class="btn btn-info btn-sm" onclick="viewDetails(${activity.id})">
              <i class="fas fa-eye"></i>
              查看詳情
            </button>
            <button class="btn btn-warning btn-sm" onclick="editActivity(${activity.id})">
              <i class="fas fa-edit"></i>
              編輯活動
            </button>
            ${activity.status === 'ongoing' ? `
              <button class="btn btn-danger btn-sm" onclick="confirmCancel(${activity.id})">
                <i class="fas fa-stop"></i>
                暫停活動
              </button>
            ` : ''}
            ${activity.status === 'upcoming' ? `
              <button class="btn btn-danger btn-sm" onclick="confirmCancel(${activity.id})">
                <i class="fas fa-times"></i>
                取消活動
              </button>
            ` : ''}
          </div>
        `;
        
        activityList.appendChild(activityCard);
      });
    }

    function filterActivities() {
      const searchTerm = document.getElementById('searchInput').value.toLowerCase();
      const statusFilter = document.getElementById('statusFilter').value;
      const categoryFilter = document.getElementById('categoryFilter').value;

      filteredActivities = activitiesData.filter(activity => {
        const matchesSearch = activity.title.toLowerCase().includes(searchTerm) ||
                            activity.description.toLowerCase().includes(searchTerm) ||
                            activity.instructor.toLowerCase().includes(searchTerm);
        const matchesStatus = !statusFilter || activity.status === statusFilter;
        const matchesCategory = !categoryFilter || activity.category === categoryFilter;

        return matchesSearch && matchesStatus && matchesCategory;
      });

      renderActivities();
      updateStats();
    }

    function resetFilters() {
      document.getElementById('searchInput').value = '';
      document.getElementById('statusFilter').value = '';
      document.getElementById('categoryFilter').value = '';
      filteredActivities = [...activitiesData];
      renderActivities();
      updateStats();
    }

    function updateStats() {
      const ongoing = filteredActivities.filter(a => a.status === 'ongoing').length;
      const upcoming = filteredActivities.filter(a => a.status === 'upcoming').length;
      const completed = filteredActivities.filter(a => a.status === 'completed').length;
      const totalParticipants = filteredActivities.reduce((sum, a) => sum + a.participants, 0);

      animateNumber('ongoingCount', ongoing);
      animateNumber('upcomingCount', upcoming);
      animateNumber('completedCount', completed);
      animateNumber('totalParticipants', totalParticipants);
    }

    function animateNumber(elementId, targetValue) {
      const element = document.getElementById(elementId);
      const startValue = parseInt(element.textContent) || 0;
      const increment = (targetValue - startValue) / 20;
      let currentValue = startValue;

      const timer = setInterval(() => {
        currentValue += increment;
        if ((increment > 0 && currentValue >= targetValue) || 
            (increment < 0 && currentValue <= targetValue) ||
            increment === 0) {
          element.textContent = targetValue;
          clearInterval(timer);
        } else {
          element.textContent = Math.floor(currentValue);
        }
      }, 50);
    }

    function viewDetails(activityId) {
      const activity = activitiesData.find(a => a.id === activityId);
      if (!activity) return;

      const statusInfo = statusMap[activity.status];
      const participantPercentage = ((activity.participants / activity.maxParticipants) * 100).toFixed(1);
      
      const modalContent = document.getElementById('modalContent');
      modalContent.innerHTML = `
        <h2 style="color: #333; margin-bottom: 20px; display: flex; align-items: center;">
          <i class="fas fa-info-circle" style="color: #11998e; margin-right: 10px;"></i>
          ${activity.title}
        </h2>
        
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-bottom: 25px;">
          <div style="background: #f8f9fa; padding: 15px; border-radius: 10px;">
            <strong style="color: #11998e;">活動狀態</strong><br>
            <span class="status-badge ${statusInfo.class}" style="margin-top: 5px;">${statusInfo.text}</span>
          </div>
          <div style="background: #f8f9fa; padding: 15px; border-radius: 10px;">
            <strong style="color: #11998e;">活動日期</strong><br>
            ${activity.startDate} ~ ${activity.endDate}
          </div>
          <div style="background: #f8f9fa; padding: 15px; border-radius: 10px;">
            <strong style="color: #11998e;">活動地點</strong><br>
            ${activity.location}
          </div>
          <div style="background: #f8f9fa; padding: 15px; border-radius: 10px;">
            <strong style="color: #11998e;">指導老師</strong><br>
            ${activity.instructor}
          </div>
        </div>
        
        <div style="background: #f8f9fa; padding: 20px; border-radius: 10px; margin-bottom: 25px;">
          <strong style="color: #11998e; display: block; margin-bottom: 10px;">參與情況</strong>
          <div style="display: flex; align-items: center; gap: 15px;">
            <div style="flex: 1; background: #e9ecef; height: 10px; border-radius: 5px; overflow: hidden;">
              <div style="width: ${participantPercentage}%; height: 100%; background: linear-gradient(90deg, #11998e 0%, #38ef7d 100%); transition: width 0.3s ease;"></div>
            </div>
            <span style="color: #666; font-weight: bold;">${activity.participants}/${activity.maxParticipants} 人 (${participantPercentage}%)</span>
          </div>
        </div>
        
        <div style="background: #f8f9fa; padding: 20px; border-radius: 10px; margin-bottom: 25px;">
          <strong style="color: #11998e; display: block; margin-bottom: 10px;">活動描述</strong>
          <p style="color: #666; line-height: 1.6; margin: 0;">${activity.description}</p>
        </div>
        
        <div style="display: flex; gap: 10px; justify-content: flex-end;">
          <button class="btn btn-secondary" onclick="closeModal()">關閉</button>
          <button class="btn btn-warning" onclick="editActivity(${activity.id}); closeModal();">
            <i class="fas fa-edit"></i> 編輯活動
          </button>
        </div>
      `;
      
      document.getElementById('activityModal').style.display = 'block';
    }

    function editActivity(activityId) {
      const activity = activitiesData.find(a => a.id === activityId);
      if (!activity) return;

      alert(`編輯活動功能開發中...\n活動：${activity.title}`);
    }

    function confirmCancel(activityId) {
      const activity = activitiesData.find(a => a.id === activityId);
      if (!activity) return;

      const action = activity.status === 'ongoing' ? '暫停' : '取消';
      if (confirm(`確定要${action}活動「${activity.title}」嗎？`)) {
        activity.status = 'cancelled';
        if (activity.status === 'cancelled') {
          activity.participants = 0;
        }
        
        filterActivities();
        showNotification(`活動「${activity.title}」已${action}`, 'success');
      }
    }

    function closeModal() {
      document.getElementById('activityModal').style.display = 'none';
    }

    window.addEventListener('click', function(event) {
      const modal = document.getElementById('activityModal');
      if (event.target === modal) {
        closeModal();
      }
    });

    function showNotification(message, type = 'info') {
      const notification = document.createElement('div');
      notification.style.cssText = `
        position: fixed;
        top: 20px;
        right: 20px;
        background: ${type === 'success' ? 'linear-gradient(135deg, #28a745 0%, #20c997 100%)' : 'linear-gradient(135deg, #17a2b8 0%, #6f42c1 100%)'};
        color: white;
        padding: 15px 25px;
        border-radius: 10px;
        box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        z-index: 10000;
        font-weight: 500;
        animation: slideIn 0.3s ease;
        cursor: pointer;
      `;
      notification.textContent = message;
      
      notification.addEventListener('click', () => {
        notification.style.animation = 'slideOut 0.3s ease';
        setTimeout(() => notification.remove(), 300);
      });
      
      if (!document.querySelector('#notificationStyles')) {
        const style = document.createElement('style');
        style.id = 'notificationStyles';
        style.textContent = `
          @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
          }
          @keyframes slideOut {
            from { transform: translateX(0); opacity: 1; }
            to { transform: translateX(100%); opacity: 0; }
          }
        `;
        document.head.appendChild(style);
      }
      
      document.body.appendChild(notification);
      
      setTimeout(() => {
        if (notification.parentNode) {
          notification.style.animation = 'slideOut 0.3s ease';
          setTimeout(() => notification.remove(), 300);
        }
      }, 3000);
    }

    document.addEventListener('keydown', function(event) {
      if (event.key === 'Escape') {
        closeModal();
      }
    });
  </script>
</body>
</html>