<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <title>幹部工作時數&出席紀錄 - 科學會管理系統</title>
  <!-- FontAwesome CDN -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    html, body {
      height: 100%;
      font-family: 'Microsoft JhengHei', 'Arial', sans-serif;
      background: linear-gradient(135deg, #8360c3 0%, #2ebf91 100%);
    }

    /* 頂部區域 */
    .header {
      height: 70px;
      background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%);
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 0 30px;
      box-shadow: 0 2px 20px rgba(0,0,0,0.1);
      position: relative;
      z-index: 100;
    }

    .header::before {
      content: '';
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      height: 3px;
      background: linear-gradient(90deg, #8360c3 0%, #2ebf91 100%);
    }

    /* Logo 和標題區域 */
    .header-left {
      display: flex;
      align-items: center;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .header-left:hover {
      transform: scale(1.02);
    }

    .header img.logo {
      height: 50px;
      filter: drop-shadow(0 2px 8px rgba(0,0,0,0.1));
      transition: transform 0.3s ease;
      margin-right: 15px;
    }

    .header-right {
      display: flex;
      align-items: center;
      gap: 25px;
      position: relative;
    }

    .icon {
      position: relative;
      padding: 10px;
      border-radius: 50%;
      background: linear-gradient(135deg, #8360c3 0%, #2ebf91 100%);
      transition: all 0.3s ease;
      cursor: pointer;
    }

    .icon:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 25px rgba(131, 96, 195, 0.4);
    }

    .icon i {
      font-size: 18px;
      color: white;
    }

    .icon::after {
      content: '5';
      position: absolute;
      top: -2px;
      right: -2px;
      background: #ff4757;
      color: white;
      border-radius: 50%;
      width: 18px;
      height: 18px;
      font-size: 11px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
    }

    .avatar {
      width: 45px;
      height: 45px;
      border-radius: 50%;
      background: linear-gradient(135deg, #8360c3 0%, #2ebf91 100%);
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.3s ease;
      border: 3px solid #fff;
      box-shadow: 0 4px 15px rgba(0,0,0,0.1);
    }

    .avatar:hover {
      transform: scale(1.1);
      box-shadow: 0 6px 20px rgba(131, 96, 195, 0.3);
    }

    .avatar i {
      font-size: 20px;
      color: white;
    }

    /* 下拉選單 */
    .dropdown {
      position: absolute;
      top: 65px;
      right: 0;
      background: white;
      border-radius: 12px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.2);
      display: none;
      min-width: 120px;
      z-index: 1000;
      overflow: hidden;
      animation: dropdownFade 0.3s ease;
    }

    @keyframes dropdownFade {
      from { opacity: 0; transform: translateY(-10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .dropdown a {
      display: flex;
      align-items: center;
      padding: 12px 16px;
      text-decoration: none;
      color: #333;
      font-size: 14px;
      transition: all 0.2s ease;
    }

    .dropdown a:hover {
      background: linear-gradient(135deg, #8360c3 0%, #2ebf91 100%);
      color: white;
    }

    .dropdown a i {
      margin-right: 8px;
      width: 16px;
    }

    /* 主體區域 */
    .main {
      display: flex;
      height: calc(100% - 70px);
      gap: 0;
    }

    .sidebar {
      width: 280px;
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(10px);
      padding: 30px 0;
      display: flex;
      flex-direction: column;
      box-shadow: 2px 0 20px rgba(0,0,0,0.1);
      position: relative;
      overflow-y: auto;
    }

    .sidebar::before {
      content: '';
      position: absolute;
      top: 0;
      right: 0;
      width: 4px;
      height: 100%;
      background: linear-gradient(180deg, #8360c3 0%, #2ebf91 100%);
    }

    .menu {
      flex: 1;
      margin-top: 20px;
    }

    .menu-item {
      display: block;
      position: relative;
    }

    .menu-link {
      display: flex;
      align-items: center;
      padding: 15px 25px;
      text-decoration: none;
      color: #555;
      font-size: 15px;
      transition: all 0.3s ease;
      border-left: 4px solid transparent;
      cursor: pointer;
    }

    .menu-link:hover, .menu-link.active {
      color: #8360c3;
      background: rgba(131, 96, 195, 0.1);
      border-left: 4px solid #8360c3;
      transform: translateX(5px);
    }

    .menu-link i {
      margin-right: 12px;
      width: 20px;
      font-size: 16px;
    }

    .menu-arrow {
      margin-left: auto;
      font-size: 12px;
      transition: transform 0.3s ease;
    }

    .menu-item.expanded .menu-arrow {
      transform: rotate(180deg);
    }

    /* 二級選單 */
    .submenu {
      max-height: 0;
      overflow: hidden;
      transition: max-height 0.3s ease;
      background: rgba(131, 96, 195, 0.05);
    }

    .submenu.show {
      max-height: 500px;
    }

    .submenu-item {
      position: relative;
    }

    .submenu-link {
      display: flex;
      align-items: center;
      padding: 12px 25px 12px 45px;
      text-decoration: none;
      color: #666;
      font-size: 14px;
      transition: all 0.3s ease;
      border-left: 4px solid transparent;
      cursor: pointer;
    }

    .submenu-link:hover {
      color: #8360c3;
      background: rgba(131, 96, 195, 0.1);
      border-left: 4px solid #8360c3;
      transform: translateX(5px);
    }

    .submenu-link i {
      margin-right: 10px;
      width: 16px;
      font-size: 14px;
    }

    .content {
      flex: 1;
      padding: 40px;
      background: rgba(255, 255, 255, 0.1);
      backdrop-filter: blur(10px);
      display: flex;
      flex-direction: column;
      overflow-y: auto;
    }

    /* 頁面標題 */
    .page-header {
      background: rgba(255, 255, 255, 0.95);
      border-radius: 20px;
      padding: 30px 40px;
      margin-bottom: 30px;
      box-shadow: 0 8px 25px rgba(0,0,0,0.1);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255, 255, 255, 0.2);
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .page-title-section h1 {
      font-size: 28px;
      color: #333;
      margin-bottom: 10px;
      font-weight: 600;
      display: flex;
      align-items: center;
    }

    .page-title-section h1 i {
      margin-right: 15px;
      color: #8360c3;
      font-size: 32px;
    }

    .page-title-section p {
      color: #666;
      font-size: 16px;
      line-height: 1.6;
    }

    /* 時間顯示區域 */
    .time-display {
      background: linear-gradient(135deg, #8360c3 0%, #2ebf91 100%);
      color: white;
      padding: 10px 20px;
      border-radius: 25px;
      font-size: 14px;
      font-weight: 500;
      display: flex;
      align-items: center;
      gap: 8px;
      box-shadow: 0 2px 10px rgba(131, 96, 195, 0.3);
      white-space: nowrap;
    }

    .time-display i {
      font-size: 16px;
      color: white;
    }

    /* 統計卡片 */
    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 20px;
      margin-bottom: 30px;
    }

    .stat-card {
      background: white;
      border-radius: 15px;
      padding: 25px;
      text-align: center;
      box-shadow: 0 4px 15px rgba(0,0,0,0.1);
      transition: all 0.3s ease;
      position: relative;
      overflow: hidden;
    }

    .stat-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 8px 25px rgba(0,0,0,0.15);
    }

    .stat-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: linear-gradient(90deg, #8360c3 0%, #2ebf91 100%);
    }

    .stat-icon {
      font-size: 32px;
      margin-bottom: 10px;
      background: linear-gradient(135deg, #8360c3 0%, #2ebf91 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }

    .stat-number {
      font-size: 28px;
      font-weight: bold;
      margin-bottom: 8px;
      color: #333;
    }

    .stat-label {
      color: #666;
      font-size: 14px;
      font-weight: 500;
    }

    .stat-change {
      font-size: 12px;
      margin-top: 5px;
    }

    .stat-change.positive {
      color: #28a745;
    }

    .stat-change.negative {
      color: #dc3545;
    }

    /* 控制面板 */
    .control-panel {
      background: rgba(255, 255, 255, 0.9);
      border-radius: 15px;
      padding: 20px;
      margin-bottom: 30px;
      box-shadow: 0 4px 15px rgba(0,0,0,0.1);
    }

    .control-row {
      display: flex;
      flex-wrap: wrap;
      gap: 15px;
      align-items: center;
      margin-bottom: 15px;
    }

    .control-row:last-child {
      margin-bottom: 0;
    }

    .form-group {
      display: flex;
      flex-direction: column;
      gap: 5px;
    }

    .form-group label {
      font-size: 14px;
      font-weight: 600;
      color: #333;
    }

    .form-control {
      padding: 10px 15px;
      border: 2px solid #e9ecef;
      border-radius: 8px;
      font-size: 14px;
      transition: all 0.3s ease;
      background: white;
      min-width: 150px;
    }

    .form-control:focus {
      outline: none;
      border-color: #8360c3;
      box-shadow: 0 0 0 3px rgba(131, 96, 195, 0.1);
    }

    .btn {
      padding: 10px 20px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-size: 14px;
      font-weight: 500;
      transition: all 0.3s ease;
      display: inline-flex;
      align-items: center;
      gap: 8px;
      text-decoration: none;
    }

    .btn-primary {
      background: linear-gradient(135deg, #8360c3 0%, #2ebf91 100%);
      color: white;
    }

    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 15px rgba(131, 96, 195, 0.4);
    }

    .btn-success {
      background: #28a745;
      color: white;
    }

    .btn-warning {
      background: #ffc107;
      color: #212529;
    }

    .btn-info {
      background: #17a2b8;
      color: white;
    }

    .btn:hover {
      transform: translateY(-1px);
    }

    /* 主要內容區域 */
    .main-content {
      display: grid;
      grid-template-columns: 2fr 1fr;
      gap: 30px;
    }

    /* 員工列表 */
    .staff-section {
      background: white;
      border-radius: 15px;
      padding: 25px;
      box-shadow: 0 4px 15px rgba(0,0,0,0.1);
    }

    .section-title {
      font-size: 20px;
      font-weight: 600;
      color: #333;
      margin-bottom: 20px;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .section-title i {
      color: #8360c3;
    }

    .staff-list {
      display: flex;
      flex-direction: column;
      gap: 15px;
    }

    .staff-item {
      background: #f8f9fa;
      border-radius: 12px;
      padding: 20px;
      transition: all 0.3s ease;
      cursor: pointer;
      border: 2px solid transparent;
    }

    .staff-item:hover {
      background: rgba(131, 96, 195, 0.05);
      border-color: rgba(131, 96, 195, 0.2);
    }

    .staff-item.selected {
      background: rgba(131, 96, 195, 0.1);
      border-color: #8360c3;
    }

    .staff-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 10px;
    }

    .staff-info h4 {
      color: #333;
      font-size: 16px;
      font-weight: 600;
      margin-bottom: 3px;
    }

    .staff-info p {
      color: #666;
      font-size: 14px;
    }

    .performance-badge {
      padding: 6px 12px;
      border-radius: 20px;
      font-size: 12px;
      font-weight: bold;
    }

    .performance-excellent {
      background: rgba(40, 167, 69, 0.2);
      color: #155724;
    }

    .performance-good {
      background: rgba(23, 162, 184, 0.2);
      color: #0c5460;
    }

    .performance-average {
      background: rgba(255, 193, 7, 0.2);
      color: #856404;
    }

    .performance-poor {
      background: rgba(220, 53, 69, 0.2);
      color: #721c24;
    }

    .staff-stats {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 15px;
      margin-top: 10px;
    }

    .staff-stat {
      text-align: center;
    }

    .staff-stat-number {
      font-size: 18px;
      font-weight: bold;
      color: #8360c3;
    }

    .staff-stat-label {
      font-size: 12px;
      color: #666;
      margin-top: 2px;
    }

    /* 詳細資訊面板 */
    .detail-section {
      background: white;
      border-radius: 15px;
      padding: 25px;
      box-shadow: 0 4px 15px rgba(0,0,0,0.1);
      height: fit-content;
    }

    .detail-empty {
      text-align: center;
      padding: 40px 20px;
      color: #666;
    }

    .detail-empty i {
      font-size: 48px;
      margin-bottom: 15px;
      opacity: 0.3;
    }

    .staff-profile {
      text-align: center;
      margin-bottom: 20px;
    }

    .staff-avatar {
      width: 80px;
      height: 80px;
      border-radius: 50%;
      background: linear-gradient(135deg, #8360c3 0%, #2ebf91 100%);
      display: flex;
      align-items: center;
      justify-content: center;
      margin: 0 auto 15px;
      font-size: 32px;
      color: white;
    }

    .staff-name {
      font-size: 20px;
      font-weight: 600;
      color: #333;
      margin-bottom: 5px;
    }

    .staff-role {
      color: #666;
      font-size: 14px;
    }

    .detail-tabs {
      display: flex;
      gap: 5px;
      margin-bottom: 20px;
      background: #f8f9fa;
      padding: 5px;
      border-radius: 10px;
    }

    .detail-tab {
      flex: 1;
      padding: 10px;
      border: none;
      background: transparent;
      border-radius: 6px;
      cursor: pointer;
      font-size: 13px;
      font-weight: 500;
      color: #666;
      transition: all 0.3s ease;
    }

    .detail-tab.active {
      background: white;
      color: #8360c3;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
    }

    .detail-content {
      display: none;
    }

    .detail-content.active {
      display: block;
    }

    .detail-item {
      background: #f8f9fa;
      padding: 15px;
      border-radius: 10px;
      margin-bottom: 10px;
    }

    .detail-item-title {
      font-weight: 600;
      color: #333;
      font-size: 14px;
      margin-bottom: 5px;
    }

    .detail-item-value {
      color: #666;
      font-size: 14px;
    }

    /* 圖表區域 */
    .chart-container {
      background: white;
      border-radius: 15px;
      padding: 25px;
      margin-top: 30px;
      box-shadow: 0 4px 15px rgba(0,0,0,0.1);
    }

    .chart-placeholder {
      height: 300px;
      background: linear-gradient(135deg, rgba(131, 96, 195, 0.1) 0%, rgba(46, 191, 145, 0.1) 100%);
      border-radius: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: #666;
      font-size: 16px;
    }

    /* 響應式設計 */
    @media (max-width: 1200px) {
      .main-content {
        grid-template-columns: 1fr;
      }
    }

    @media (max-width: 768px) {
      .main { flex-direction: column; }
      .sidebar { width: 100%; height: auto; }
      .content { padding: 20px; }
      .page-header { flex-direction: column; align-items: flex-start; gap: 20px; }
      .time-display { align-self: stretch; justify-content: center; }
      .stats-grid { grid-template-columns: repeat(2, 1fr); }
      .control-row { flex-direction: column; align-items: stretch; }
      .staff-stats { grid-template-columns: repeat(2, 1fr); }
      .staff-header { flex-direction: column; align-items: flex-start; gap: 10px; }
    }

    /* 滾動條美化 */
    ::-webkit-scrollbar { width: 8px; }
    ::-webkit-scrollbar-track { background: rgba(0,0,0,0.1); }
    ::-webkit-scrollbar-thumb {
      background: linear-gradient(135deg, #8360c3 0%, #2ebf91 100%);
      border-radius: 4px;
    }
  </style>
</head>
<body>
  <!-- 頂部欄 -->
  <div class="header">
    <div class="header-left" onclick="location.href='admin_dashboard.html';">
      <img src="image/logo1.gif" alt="Logo" class="logo">
    </div>
    <div class="header-right">
      <div class="icon"><i class="fas fa-bell"></i></div>
      <div class="avatar" id="avatar">
        <i class="fas fa-user-shield"></i>
      </div>
      <div class="dropdown" id="dropdown">
        <a href="login_admin.html">
          <i class="fas fa-sign-out-alt"></i>
          登出
        </a>
      </div>
    </div>
  </div>

  <!-- 主區塊 -->
  <div class="main">
    <div class="sidebar">
      <div class="menu">
        <!-- 科學會首頁 -->
        <div class="menu-item">
          <a href="admin_dashboard.html" class="menu-link">
            <i class="fas fa-home"></i>
            科學會首頁
          </a>
        </div>

        <!-- 活動行事曆 -->
        <div class="menu-item">
          <a href="activity_calendar.html" class="menu-link">
            <i class="fas fa-calendar"></i>
            活動行事曆
          </a>
        </div>

        <!-- 幹部行事曆 -->
        <div class="menu-item">
          <a href="admin_executive.html" class="menu-link">
            <i class="fas fa-calendar-alt"></i>
            幹部行事曆
          </a>
        </div>

        <!-- 發布公告 -->
        <div class="menu-item">
          <a href="publish_announcement.html" class="menu-link">
            <i class="fas fa-bullhorn"></i>
            發布公告
          </a>
        </div>

        <!-- 活動管理 -->
        <div class="menu-item">
          <div class="menu-link" onclick="toggleMenu(this); return false;">
            <i class="fas fa-tasks"></i>
            活動管理
            <i class="fas fa-chevron-down menu-arrow"></i>
          </div>
          <div class="submenu">
            <div class="submenu-item">
              <a href="finance_management.html" class="submenu-link">
                <i class="fas fa-coins"></i>
                總務組
              </a>
            </div>
            <div class="submenu-item">
              <a href="admin_customer_service.html" class="submenu-link">
                <i class="fas fa-handshake"></i>
                公關組
              </a>
            </div>
          </div>
        </div>
      </div>
    </div>
    
    <div class="content">
      <!-- 頁面標題 -->
      <div class="page-header">
        <div class="page-title-section">
          <h1><i class="fas fa-clock"></i>幹部工作時數&出席紀錄</h1>
          <p>統計分析幹部工作表現，追蹤出勤狀況與工時記錄，提升團隊管理效率</p>
        </div>
        <div class="time-display">
          <i class="fas fa-clock"></i>
          <span id="timeDisplay">2025年09月18日 星期四 上午10:41:27</span>
        </div>
      </div>

      <!-- 統計概覽 -->
      <div class="stats-grid">
        <div class="stat-card">
          <i class="fas fa-users stat-icon"></i>
          <div class="stat-number" id="totalStaff">23</div>
          <div class="stat-label">活躍幹部數</div>
          <div class="stat-change positive">+2 較上月</div>
        </div>
        <div class="stat-card">
          <i class="fas fa-clock stat-icon"></i>
          <div class="stat-number" id="totalHours">1,847</div>
          <div class="stat-label">本月總工時</div>
          <div class="stat-change positive">+156h 較上月</div>
        </div>
        <div class="stat-card">
          <i class="fas fa-calendar-check stat-icon"></i>
          <div class="stat-number" id="attendanceRate">92.5%</div>
          <div class="stat-label">平均出席率</div>
          <div class="stat-change positive">+3.2% 較上月</div>
        </div>
        <div class="stat-card">
          <i class="fas fa-star stat-icon"></i>
          <div class="stat-number" id="avgPerformance">8.3</div>
          <div class="stat-label">平均績效分數</div>
          <div class="stat-change positive">+0.5 較上月</div>
        </div>
      </div>

      <!-- 控制面板 -->
      <div class="control-panel">
        <div class="control-row">
          <div class="form-group">
            <label>統計期間</label>
            <select class="form-control" id="periodSelect">
              <option value="current_month">本月</option>
              <option value="last_month">上月</option>
              <option value="current_quarter">本季</option>
              <option value="custom">自訂範圍</option>
            </select>
          </div>
          <div class="form-group">
            <label>部門篩選</label>
            <select class="form-control" id="departmentSelect">
              <option value="">全部部門</option>
              <option value="secretariat">文書組</option>
              <option value="publicity">美宣組</option>
              <option value="activity">活動組</option>
              <option value="finance">總務組</option>
              <option value="public_relations">公關組</option>
            </select>
          </div>
          <div class="form-group">
            <label>績效篩選</label>
            <select class="form-control" id="performanceSelect">
              <option value="">全部等級</option>
              <option value="excellent">優秀 (9-10分)</option>
              <option value="good">良好 (7-8分)</option>
              <option value="average">普通 (5-6分)</option>
              <option value="poor">待改進 (<5分)</option>
            </select>
          </div>
        </div>
        <div class="control-row">
          <button class="btn btn-primary" onclick="applyFilters()">
            <i class="fas fa-filter"></i>套用篩選
          </button>
          <button class="btn btn-success" onclick="exportReport()">
            <i class="fas fa-download"></i>匯出報表
          </button>
          <button class="btn btn-warning" onclick="generatePayroll()">
            <i class="fas fa-money-bill-wave"></i>生成薪資單
          </button>
          <button class="btn btn-info" onclick="scheduleReport()">
            <i class="fas fa-calendar-alt"></i>排程報告
          </button>
        </div>
      </div>

      <!-- 主要內容 -->
      <div class="main-content">
        <!-- 員工列表 -->
        <div class="staff-section">
          <div class="section-title">
            <i class="fas fa-users"></i>
            幹部列表
          </div>
          <div class="staff-list" id="staffList">
            <!-- 員工項目將由JavaScript動態生成 -->
          </div>
        </div>

        <!-- 詳細資訊 -->
        <div class="detail-section">
          <div class="section-title">
            <i class="fas fa-user-circle"></i>
            詳細資訊
          </div>
          <div class="detail-empty" id="detailEmpty">
            <i class="fas fa-hand-point-left"></i>
            <p>請選擇左側幹部以查看詳細資訊</p>
          </div>
          <div class="detail-content-wrapper" id="detailContent" style="display: none;">
            <div class="staff-profile" id="staffProfile">
              <!-- 個人資料將由JavaScript填充 -->
            </div>
            <div class="detail-tabs">
              <button class="detail-tab active" onclick="switchDetailTab('overview')">概覽</button>
              <button class="detail-tab" onclick="switchDetailTab('hours')">工時</button>
              <button class="detail-tab" onclick="switchDetailTab('attendance')">出勤</button>
              <button class="detail-tab" onclick="switchDetailTab('performance')">績效</button>
            </div>
            <div id="overview" class="detail-content active">
              <!-- 概覽內容 -->
            </div>
            <div id="hours" class="detail-content">
              <!-- 工時內容 -->
            </div>
            <div id="attendance" class="detail-content">
              <!-- 出勤內容 -->
            </div>
            <div id="performance" class="detail-content">
              <!-- 績效內容 -->
            </div>
          </div>
        </div>
      </div>

      <!-- 圖表區域 -->
      <div class="chart-container">
        <div class="section-title">
          <i class="fas fa-chart-bar"></i>
          工時統計圖表
        </div>
        <div class="chart-placeholder">
          📊 工時趨勢圖表 (可整合 Chart.js 或其他圖表庫)
        </div>
      </div>
    </div>
  </div>

  <!-- JavaScript -->
  <script>
    // 模擬幹部數據
    const staffData = [
      {
        id: 1,
        name: "王小明",
        department: "activity",
        position: "活動組長",
        joinDate: "2024-09-01",
        totalHours: 156,
        monthHours: 42,
        attendanceRate: 95.2,
        performance: 9.1,
        performanceLevel: "excellent",
        avatar: "👨‍💼",
        recentActivities: [
          { date: "2025-09-18", hours: 8, activity: "科學營籌備會議" },
          { date: "2025-09-17", hours: 6, activity: "活動場地勘查" },
          { date: "2025-09-16", hours: 7, activity: "預算規劃討論" }
        ]
      },
      {
        id: 2,
        name: "李美華",
        department: "publicity",
        position: "美宣組員",
        joinDate: "2024-10-15",
        totalHours: 134,
        monthHours: 38,
        attendanceRate: 88.7,
        performance: 8.3,
        performanceLevel: "good",
        avatar: "👩‍🎨",
        recentActivities: [
          { date: "2025-09-18", hours: 9, activity: "海報設計製作" },
          { date: "2025-09-17", hours: 5, activity: "社群媒體更新" },
          { date: "2025-09-16", hours: 8, activity: "活動宣傳素材" }
        ]
      },
      {
        id: 3,
        name: "陳志強",
        department: "secretariat",
        position: "文書組員",
        joinDate: "2024-08-20",
        totalHours: 142,
        monthHours: 35,
        attendanceRate: 92.1,
        performance: 7.8,
        performanceLevel: "good",
        avatar: "👨‍📊",
        recentActivities: [
          { date: "2025-09-18", hours: 7, activity: "會議記錄整理" },
          { date: "2025-09-17", hours: 6, activity: "文件檔案整理" },
          { date: "2025-09-16", hours: 8, activity: "報告撰寫" }
        ]
      },
      {
        id: 4,
        name: "林雅婷",
        department: "finance",
        position: "總務組長",
        joinDate: "2024-09-10",
        totalHours: 168,
        monthHours: 45,
        attendanceRate: 97.3,
        performance: 9.5,
        performanceLevel: "excellent",
        avatar: "👩‍💼",
        recentActivities: [
          { date: "2025-09-18", hours: 8, activity: "預算審核" },
          { date: "2025-09-17", hours: 9, activity: "採購物品清單" },
          { date: "2025-09-16", hours: 7, activity: "財務報表製作" }
        ]
      },
      {
        id: 5,
        name: "張偉豪",
        department: "public_relations",
        position: "公關組員",
        joinDate: "2024-11-01",
        totalHours: 98,
        monthHours: 28,
        attendanceRate: 82.5,
        performance: 6.9,
        performanceLevel: "average",
        avatar: "👨‍🤝‍👨",
        recentActivities: [
          { date: "2025-09-18", hours: 6, activity: "廠商聯繫" },
          { date: "2025-09-17", hours: 4, activity: "合作提案準備" },
          { date: "2025-09-16", hours: 5, activity: "關係維護" }
        ]
      }
    ];

    let filteredStaff = [...staffData];
    let selectedStaff = null;

    // 部門映射
    const departmentMap = {
      'secretariat': '文書組',
      'publicity': '美宣組',
      'activity': '活動組',
      'finance': '總務組',
      'public_relations': '公關組'
    };

    // 績效等級映射
    const performanceMap = {
      'excellent': { text: '優秀', class: 'performance-excellent' },
      'good': { text: '良好', class: 'performance-good' },
      'average': { text: '普通', class: 'performance-average' },
      'poor': { text: '待改進', class: 'performance-poor' }
    };

    // 頁面載入後執行
    document.addEventListener('DOMContentLoaded', function() {
      updateTime();
      setInterval(updateTime, 1000);
      renderStaffList();
      updateOverallStats();
    });

    // 更新時間顯示
    function updateTime() {
      const now = new Date();
      const options = {
        year: 'numeric',
        month: '2-digit',
        day: '2-digit',
        weekday: 'long',
        hour: '2-digit',
        minute: '2-digit',
        second: '2-digit',
        hour12: true
      };
      
      let timeString = now.toLocaleDateString('zh-TW', options);
      timeString = timeString.replace(/(\d{4})\/(\d{1,2})\/(\d{1,2})/, '$1年$2月$3日').replace(/\s+/g, ' ');
      document.getElementById('timeDisplay').textContent = timeString;
    }

    // 頭像下拉選單控制
    const avatar = document.getElementById('avatar');
    const dropdown = document.getElementById('dropdown');

    avatar.addEventListener('click', () => {
      dropdown.style.display = dropdown.style.display === 'block' ? 'none' : 'block';
    });

    window.addEventListener('click', function(e) {
      if (!avatar.contains(e.target) && !dropdown.contains(e.target)) {
        dropdown.style.display = 'none';
      }
    });

    // 選單控制
    function toggleMenu(element) {
      const menuItem = element.parentElement;
      const submenu = menuItem.querySelector('.submenu');
      const isExpanded = menuItem.classList.contains('expanded');
      
      document.querySelectorAll('.menu-item').forEach(item => {
        if (item !== menuItem) {
          item.classList.remove('expanded');
          const otherSubmenu = item.querySelector('.submenu');
          if (otherSubmenu) {
            otherSubmenu.classList.remove('show');
          }
        }
      });
      
      if (isExpanded) {
        menuItem.classList.remove('expanded');
        submenu.classList.remove('show');
      } else {
        menuItem.classList.add('expanded');
        submenu.classList.add('show');
      }
    }

    // 渲染幹部列表
    function renderStaffList() {
      const staffList = document.getElementById('staffList');
      staffList.innerHTML = '';

      if (filteredStaff.length === 0) {
        staffList.innerHTML = `
          <div style="text-align: center; padding: 40px; color: #666;">
            <i class="fas fa-user-times" style="font-size: 48px; margin-bottom: 20px; opacity: 0.3;"></i>
            <p>沒有找到符合條件的幹部</p>
          </div>
        `;
        return;
      }

      filteredStaff.forEach(staff => {
        const performanceInfo = performanceMap[staff.performanceLevel];
        const staffItem = document.createElement('div');
        staffItem.className = 'staff-item';
        staffItem.onclick = () => selectStaff(staff.id);
        
        staffItem.innerHTML = `
          <div class="staff-header">
            <div class="staff-info">
              <h4>${staff.avatar} ${staff.name}</h4>
              <p>${departmentMap[staff.department]} | ${staff.position}</p>
            </div>
            <div class="performance-badge ${performanceInfo.class}">
              ${performanceInfo.text}
            </div>
          </div>
          <div class="staff-stats">
            <div class="staff-stat">
              <div class="staff-stat-number">${staff.monthHours}h</div>
              <div class="staff-stat-label">本月工時</div>
            </div>
            <div class="staff-stat">
              <div class="staff-stat-number">${staff.attendanceRate}%</div>
              <div class="staff-stat-label">出席率</div>
            </div>
            <div class="staff-stat">
              <div class="staff-stat-number">${staff.performance}</div>
              <div class="staff-stat-label">績效分數</div>
            </div>
          </div>
        `;
        
        staffList.appendChild(staffItem);
      });
    }

    // 選擇幹部
    function selectStaff(staffId) {
      // 移除之前選中的項目
      document.querySelectorAll('.staff-item').forEach(item => {
        item.classList.remove('selected');
      });
      
      // 選中當前項目
      event.currentTarget.classList.add('selected');
      
      // 獲取幹部數據
      selectedStaff = staffData.find(s => s.id === staffId);
      if (!selectedStaff) return;
      
      // 顯示詳細資訊
      document.getElementById('detailEmpty').style.display = 'none';
      document.getElementById('detailContent').style.display = 'block';
      
      // 更新個人資料
      updateStaffProfile();
      updateDetailContent();
    }

    // 更新個人資料
    function updateStaffProfile() {
      const performanceInfo = performanceMap[selectedStaff.performanceLevel];
      document.getElementById('staffProfile').innerHTML = `
        <div class="staff-avatar">${selectedStaff.avatar}</div>
        <div class="staff-name">${selectedStaff.name}</div>
        <div class="staff-role">${departmentMap[selectedStaff.department]} | ${selectedStaff.position}</div>
        <div class="performance-badge ${performanceInfo.class}" style="margin-top: 10px;">
          ${performanceInfo.text} (${selectedStaff.performance}分)
        </div>
      `;
    }

    // 更新詳細內容
    function updateDetailContent() {
      // 概覽內容
      document.getElementById('overview').innerHTML = `
        <div class="detail-item">
          <div class="detail-item-title">加入日期</div>
          <div class="detail-item-value">${selectedStaff.joinDate}</div>
        </div>
        <div class="detail-item">
          <div class="detail-item-title">總工作時數</div>
          <div class="detail-item-value">${selectedStaff.totalHours} 小時</div>
        </div>
        <div class="detail-item">
          <div class="detail-item-title">本月工時</div>
          <div class="detail-item-value">${selectedStaff.monthHours} 小時</div>
        </div>
        <div class="detail-item">
          <div class="detail-item-title">出席率</div>
          <div class="detail-item-value">${selectedStaff.attendanceRate}%</div>
        </div>
      `;

      // 工時內容
      let hoursContent = '<div class="detail-item"><div class="detail-item-title">近期工時記錄</div></div>';
      selectedStaff.recentActivities.forEach(activity => {
        hoursContent += `
          <div class="detail-item">
            <div class="detail-item-title">${activity.date}</div>
            <div class="detail-item-value">${activity.hours}小時 - ${activity.activity}</div>
          </div>
        `;
      });
      document.getElementById('hours').innerHTML = hoursContent;

      // 出勤內容
      document.getElementById('attendance').innerHTML = `
        <div class="detail-item">
          <div class="detail-item-title">本月出席率</div>
          <div class="detail-item-value">${selectedStaff.attendanceRate}%</div>
        </div>
        <div class="detail-item">
          <div class="detail-item-title">準時出席</div>
          <div class="detail-item-value">18 天</div>
        </div>
        <div class="detail-item">
          <div class="detail-item-title">遲到次數</div>
          <div class="detail-item-value">2 次</div>
        </div>
        <div class="detail-item">
          <div class="detail-item-title">請假天數</div>
          <div class="detail-item-value">1 天</div>
        </div>
      `;

      // 績效內容
      document.getElementById('performance').innerHTML = `
        <div class="detail-item">
          <div class="detail-item-title">綜合評分</div>
          <div class="detail-item-value">${selectedStaff.performance} / 10</div>
        </div>
        <div class="detail-item">
          <div class="detail-item-title">工作態度</div>
          <div class="detail-item-value">9.2 / 10</div>
        </div>
        <div class="detail-item">
          <div class="detail-item-title">任務完成度</div>
          <div class="detail-item-value">8.8 / 10</div>
        </div>
        <div class="detail-item">
          <div class="detail-item-title">團隊合作</div>
          <div class="detail-item-value">9.5 / 10</div>
        </div>
      `;
    }

    // 切換詳細標籤
    function switchDetailTab(tabName) {
      document.querySelectorAll('.detail-tab').forEach(tab => tab.classList.remove('active'));
      document.querySelectorAll('.detail-content').forEach(content => content.classList.remove('active'));
      
      event.target.classList.add('active');
      document.getElementById(tabName).classList.add('active');
    }

    // 套用篩選器
    function applyFilters() {
      const departmentFilter = document.getElementById('departmentSelect').value;
      const performanceFilter = document.getElementById('performanceSelect').value;

      filteredStaff = staffData.filter(staff => {
        const matchesDepartment = !departmentFilter || staff.department === departmentFilter;
        const matchesPerformance = !performanceFilter || staff.performanceLevel === performanceFilter;
        return matchesDepartment && matchesPerformance;
      });

      renderStaffList();
      updateOverallStats();
    }

    // 更新整體統計
    function updateOverallStats() {
      const totalStaff = filteredStaff.length;
      const totalHours = filteredStaff.reduce((sum, staff) => sum + staff.monthHours, 0);
      const avgAttendance = (filteredStaff.reduce((sum, staff) => sum + staff.attendanceRate, 0) / totalStaff).toFixed(1);
      const avgPerformance = (filteredStaff.reduce((sum, staff) => sum + staff.performance, 0) / totalStaff).toFixed(1);

      // 動畫更新數字
      animateNumber('totalStaff', totalStaff);
      animateNumber('totalHours', totalHours);
      document.getElementById('attendanceRate').textContent = avgAttendance + '%';
      document.getElementById('avgPerformance').textContent = avgPerformance;
    }

    // 數字動畫效果
    function animateNumber(elementId, targetValue) {
      const element = document.getElementById(elementId);
      const startValue = parseInt(element.textContent) || 0;
      const increment = (targetValue - startValue) / 20;
      let currentValue = startValue;

      const timer = setInterval(() => {
        currentValue += increment;
        if ((increment > 0 && currentValue >= targetValue) || 
            (increment < 0 && currentValue <= targetValue) ||
            increment === 0) {
          element.textContent = targetValue;
          clearInterval(timer);
        } else {
          element.textContent = Math.floor(currentValue);
        }
      }, 50);
    }

    // 匯出報表
    function exportReport() {
      alert('匯出工時報表功能開發中...\n將包含：\n• 個人工時明細\n• 出席率統計\n• 績效評估報告');
    }

    // 生成薪資單
    function generatePayroll() {
      alert('生成薪資單功能開發中...\n將根據工時自動計算薪資');
    }

    // 排程報告
    function scheduleReport() {
      alert('排程報告功能開發中...\n可設定定期自動產生報表');
    }

    // 點擊其他地方關閉選單
    document.addEventListener('click', function(e) {
      if (!e.target.closest('.menu')) {
        document.querySelectorAll('.menu-item').forEach(item => {
          item.classList.remove('expanded');
          const submenu = item.querySelector('.submenu');
          if (submenu) {
            submenu.classList.remove('show');
          }
        });
      }
    });
  </script>
</body>
</html>
              <a href="admin_activity_publish.html" class="submenu-link">
                <i class="fas fa-plus-circle"></i>
                發布活動
              </a>
            </div>
            <div class="submenu-item">
              <a href="admin_name_manage.html" class="submenu-link">
                <i class="fas fa-user-edit"></i>
                報名人員名單管理
              </a>
            </div>
            <div class="submenu-item">
              <a href="admin_table_publish.html" class="submenu-link">
                <i class="fas fa-comment-alt"></i>
                發布活動反饋表單
              </a>
            </div>
            <div class="submenu-item">
              <a href="admin_statistics.html" class="submenu-link">
                <i class="fas fa-trophy"></i>
                統計活動/比賽名次結果
              </a>
            </div>
            <div class="submenu-item">
              <a href="admin_analysis.html" class="submenu-link">
                <i class="fas fa-chart-bar"></i>
                活動分析
              </a>
            </div>
            <div class="submenu-item">
              <a href="activity_achievements.html" class="submenu-link">
                <i class="fas fa-images"></i>
                活動成果牆
              </a>
            </div>
            <div class="submenu-item">
              <a href="admin_upload_files.html" class="submenu-link">
                <i class="fas fa-eye"></i>
                圖片識別
              </a>
            </div>
            <div class="submenu-item">
              <a href="auto_notification.html" class="submenu-link">
                <i class="fas fa-bell"></i>
                自動通知推播
              </a>
            </div>
          </div>
        </div>

        <!-- 開會紀錄 -->
        <div class="menu-item">
          <a href="meeting_records.html" class="menu-link">
            <i class="fas fa-clipboard"></i>
            開會紀錄
          </a>
        </div>

        <!-- 線上排班 -->
        <div class="menu-item">
          <a href="online_scheduling.html" class="menu-link">
            <i class="fas fa-user-clock"></i>
            線上排班
          </a>
        </div>

        <!-- 內部請假審核&簽到表 -->
        <div class="menu-item">
          <a href="admin_request_review.html" class="menu-link">
            <i class="fas fa-file-signature"></i>
            內部請假審核&簽到表
          </a>
        </div>

        <!-- 幹部工作時數&出席紀錄 -->
        <div class="menu-item">
          <a href="admin_department_manage.html" class="menu-link active">
            <i class="fas fa-clock"></i>
            幹部工作時數&出席紀錄
          </a>
        </div>

        <!-- 各類審核單 -->
        <div class="menu-item">
          <a href="approval_forms.html" class="menu-link">
            <i class="fas fa-file-check"></i>
            各類審核單
          </a>
        </div>

        <!-- 各組管理事項 -->
        <div class="menu-item">
          <div class="menu-link" onclick="toggleMenu(this); return false;">
            <i class="fas fa-users-cog"></i>
            各組管理事項
            <i class="fas fa-chevron-down menu-arrow"></i>
          </div>
          <div class="submenu">
            <div class="submenu-item">
              <a href="secretariat_management.html" class="submenu-link">
                <i class="fas fa-file-alt"></i>
                文書組
              </a>
            </div>
            <div class="submenu-item">
              <a href="publicity_management.html" class="submenu-link">
                <i class="fas fa-paint-brush"></i>
                美宣組
              </a>
            </div>
            <div class="submenu-item">
              <a href="activity_management.html" class="submenu-link">
                <i class="fas fa-calendar-plus"></i>
                活動組
              </a>
            </div>
            <div class="submenu-item">