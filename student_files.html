<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8" />
<title>查看上傳檔案</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC&display=swap" rel="stylesheet" />
<style>
html, body { margin:0; padding:0; height:100%; font-family:'Microsoft JhengHei','Noto Sans TC',sans-serif; background: linear-gradient(135deg,#667eea 0%,#764ba2 100%); }
.header { height:70px; display:flex; align-items:center; justify-content:space-between; padding:0 30px; background:linear-gradient(135deg,#fff 0%,#f8f9fa 100%); box-shadow:0 2px 20px rgba(0,0,0,0.1); position:relative; z-index:100; }
.header::before { content:''; position:absolute; bottom:0; left:0; right:0; height:3px; background:linear-gradient(90deg,#667eea 0%,#764ba2 100%); }
.header img.logo { height:50px; cursor:pointer; }
.header-right { display:flex; align-items:center; gap:25px; position:relative; }
.icon, .avatar { width:40px; height:40px; border-radius:50%; display:flex; align-items:center; justify-content:center; background:linear-gradient(135deg,#667eea 0%,#764ba2 100%); color:white; cursor:pointer; }
.dropdown-menu { position: absolute; top: 70px; right: 0; background: white; border-radius: 8px; box-shadow: 0 5px 15px rgba(0,0,0,0.15); display: none; flex-direction: column; min-width: 140px; z-index: 200; }
.dropdown-menu a { padding: 10px 15px; text-decoration: none; color: #333; display: block; font-size: 14px; }
.dropdown-menu a:hover { background: #f5f5f5; color: #667eea; }
.main { display:flex; height:calc(100% - 70px); min-height:0; }
.sidebar { width:250px; background:rgba(255,255,255,0.95); backdrop-filter:blur(10px); display:flex; flex-direction:column; padding-top:30px; overflow-y:auto; min-height:0; scrollbar-width: thin; scrollbar-color: #667eea rgba(0,0,0,0.1); transition:all 0.3s ease; }
.sidebar::-webkit-scrollbar { width:8px; }
.sidebar::-webkit-scrollbar-track { background: rgba(0,0,0,0.05); border-radius:4px; }
.sidebar::-webkit-scrollbar-thumb { background-color:#667eea; border-radius:4px; }
.menu a { display:flex; align-items:center; padding:15px 30px; text-decoration:none; color:#555; font-size:16px; transition:all 0.3s ease; border-left:4px solid transparent; }
.menu a:hover, .menu a.active { color:#667eea; background:rgba(102,126,234,0.1); border-left:4px solid #667eea; }
.menu a i { margin-right:15px; }
.content { flex:1; padding:40px; background:rgba(255,255,255,0.1); backdrop-filter:blur(10px); overflow-y:auto; min-height:0; }
.files-container { max-width:1000px; margin:0 auto; padding:40px; background:rgba(255,255,255,0.95); border-radius:20px; box-shadow:0 5px 20px rgba(0,0,0,0.1); }
.files-container h2 { text-align:center; margin-bottom:15px; color:#333; display:flex; align-items:center; justify-content:center; gap:12px; }
.files-container .subtitle { text-align:center; color:#666; font-size:14px; margin-bottom:35px; }

/* 統計卡片 */
.stats-grid { display:grid; grid-template-columns:repeat(auto-fit, minmax(150px, 1fr)); gap:20px; margin-bottom:35px; }
.stat-card { background:linear-gradient(135deg, #667eea 0%, #764ba2 100%); color:white; padding:25px 20px; border-radius:12px; text-align:center; box-shadow:0 4px 12px rgba(102,126,234,0.3); transition:all 0.3s ease; position:relative; overflow:hidden; }
.stat-card::before { content:''; position:absolute; top:-50%; right:-50%; width:100%; height:100%; background:radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%); }
.stat-card:hover { transform:translateY(-5px); box-shadow:0 8px 20px rgba(102,126,234,0.4); }
.stat-card .value { font-size:28px; font-weight:bold; margin-bottom:8px; position:relative; z-index:1; }
.stat-card .label { font-size:13px; opacity:0.9; position:relative; z-index:1; }

/* 工具列 */
.toolbar { display:flex; gap:12px; margin-bottom:25px; flex-wrap:wrap; align-items:center; }
.search-box { flex:1; min-width:200px; position:relative; }
.search-box input { width:100%; padding:12px 40px 12px 15px; border:1px solid #ddd; border-radius:8px; font-size:14px; transition:all 0.3s ease; }
.search-box input:focus { outline:none; border-color:#667eea; box-shadow:0 0 0 3px rgba(102,126,234,0.1); }
.search-box i { position:absolute; right:15px; top:50%; transform:translateY(-50%); color:#888; transition:color 0.3s ease; pointer-events:none; }
.search-box input:focus ~ i { color:#667eea; }
.filter-select, .sort-select { padding:12px 15px; border:1px solid #ddd; border-radius:8px; font-size:14px; cursor:pointer; background:white; transition:all 0.3s ease; }
.filter-select:hover, .sort-select:hover { border-color:#667eea; box-shadow:0 2px 8px rgba(102,126,234,0.1); }
.filter-select:focus, .sort-select:focus { outline:none; border-color:#667eea; box-shadow:0 0 0 3px rgba(102,126,234,0.1); }
.batch-actions { display:flex; gap:10px; margin-bottom:25px; }
.btn-batch { padding:12px 18px; border:none; border-radius:8px; cursor:pointer; font-size:13px; font-weight:500; transition:all 0.3s ease; display:flex; align-items:center; gap:6px; }
.btn-select-all { background:#667eea; color:white; box-shadow:0 2px 8px rgba(102,126,234,0.2); }
.btn-select-all:hover { background:#5a6ddd; transform:translateY(-2px); box-shadow:0 4px 12px rgba(102,126,234,0.3); }
.btn-delete-selected { background:#f44336; color:white; box-shadow:0 2px 8px rgba(244,67,54,0.2); }
.btn-delete-selected:hover:not(:disabled) { background:#d32f2f; transform:translateY(-2px); box-shadow:0 4px 12px rgba(244,67,54,0.3); }
.btn-batch:disabled { opacity:0.5; cursor:not-allowed; transform:none; }

/* 檔案項目 */
.file-item { display:flex; align-items:center; padding:18px 22px; border:1px solid #e0e0e0; border-radius:12px; margin-bottom:15px; background:white; transition:all 0.3s ease; position:relative; }
.file-item::before { content:''; position:absolute; left:0; top:0; bottom:0; width:4px; background:linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius:12px 0 0 12px; opacity:0; transition:opacity 0.3s ease; }
.file-item:hover { box-shadow:0 6px 20px rgba(102,126,234,0.2); border-color:#667eea; transform:translateX(4px); }
.file-item:hover::before { opacity:1; }
.file-item.selected { background:linear-gradient(135deg, rgba(102,126,234,0.05) 0%, rgba(118,75,162,0.05) 100%); border-color:#667eea; }
.file-item.selected::before { opacity:1; }
.file-checkbox { margin-right:18px; width:18px; height:18px; cursor:pointer; accent-color:#667eea; }
.file-info { display:flex; align-items:center; gap:18px; flex:1; min-width:0; }
.file-icon { width:48px; height:48px; border-radius:10px; display:flex; align-items:center; justify-content:center; font-size:20px; transition:all 0.3s ease; position:relative; }
.file-icon::after { content:''; position:absolute; inset:0; border-radius:10px; background:radial-gradient(circle at 30% 30%, rgba(255,255,255,0.3), transparent); }
.file-item:hover .file-icon { transform:scale(1.1) rotate(5deg); }
.file-icon.image { background:linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%); color:#2196f3; box-shadow:0 2px 8px rgba(33,150,243,0.2); }
.file-icon.pdf { background:linear-gradient(135deg, #ffebee 0%, #ffcdd2 100%); color:#f44336; box-shadow:0 2px 8px rgba(244,67,54,0.2); }
.file-icon.word { background:linear-gradient(135deg, #e8f5e9 0%, #c8e6c9 100%); color:#4caf50; box-shadow:0 2px 8px rgba(76,175,80,0.2); }
.file-icon.other { background:linear-gradient(135deg, #f5f5f5 0%, #e0e0e0 100%); color:#757575; box-shadow:0 2px 8px rgba(117,117,117,0.2); }
.file-details { flex:1; min-width:0; }
.file-name { font-size:15px; color:#333; font-weight:500; margin-bottom:6px; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
.file-meta { font-size:12px; color:#888; }
.file-meta span { margin-right:18px; }
.btn-group { display:flex; gap:10px; }
.view-btn, .download-btn, .delete-btn { border:none; padding:10px 18px; border-radius:8px; cursor:pointer; transition:all 0.3s ease; font-size:13px; font-weight:500; display:flex; align-items:center; gap:6px; }
.view-btn { background:#667eea; color:white; }
.view-btn:hover { background:#5a6ddd; transform:translateY(-2px); box-shadow:0 4px 8px rgba(102,126,234,0.3); }
.download-btn { background:#4caf50; color:white; }
.download-btn:hover { background:#45a049; transform:translateY(-2px); box-shadow:0 4px 8px rgba(76,175,80,0.3); }
.delete-btn { background:#f44336; color:white; }
.delete-btn:hover { background:#d32f2f; transform:translateY(-2px); box-shadow:0 4px 8px rgba(244,67,54,0.3); }px; background:white; transition:all 0.3s ease; position:relative; }
.file-item::before { content:''; position:absolute; left:0; top:0; bottom:0; width:4px; background:linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius:12px 0 0 12px; opacity:0; transition:opacity 0.3s ease; }
.file-item:hover { box-shadow:0 6px 20px rgba(102,126,234,0.2); border-color:#667eea; transform:translateX(4px); }
.file-item:hover::before { opacity:1; }
.file-item.selected { background:linear-gradient(135deg, rgba(102,126,234,0.05) 0%, rgba(118,75,162,0.05) 100%); border-color:#667eea; }
.file-item.selected::before { opacity:1; }
.file-checkbox { margin-right:15px; width:18px; height:18px; cursor:pointer; accent-color:#667eea; }
.file-info { display:flex; align-items:center; gap:15px; flex:1; min-width:0; }
.file-icon { width:45px; height:45px; border-radius:10px; display:flex; align-items:center; justify-content:center; font-size:20px; transition:all 0.3s ease; position:relative; }
.file-icon::after { content:''; position:absolute; inset:0; border-radius:10px; background:radial-gradient(circle at 30% 30%, rgba(255,255,255,0.3), transparent); }
.file-item:hover .file-icon { transform:scale(1.1) rotate(5deg); }
.file-icon.image { background:linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%); color:#2196f3; box-shadow:0 2px 8px rgba(33,150,243,0.2); }
.file-icon.pdf { background:linear-gradient(135deg, #ffebee 0%, #ffcdd2 100%); color:#f44336; box-shadow:0 2px 8px rgba(244,67,54,0.2); }
.file-icon.word { background:linear-gradient(135deg, #e8f5e9 0%, #c8e6c9 100%); color:#4caf50; box-shadow:0 2px 8px rgba(76,175,80,0.2); }
.file-icon.other { background:linear-gradient(135deg, #f5f5f5 0%, #e0e0e0 100%); color:#757575; box-shadow:0 2px 8px rgba(117,117,117,0.2); }
.file-details { flex:1; min-width:0; }
.file-name { font-size:15px; color:#333; font-weight:500; margin-bottom:4px; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
.file-meta { font-size:12px; color:#888; }
.file-meta span { margin-right:15px; }
.btn-group { display:flex; gap:8px; }
.view-btn, .download-btn, .delete-btn { border:none; padding:8px 16px; border-radius:8px; cursor:pointer; transition:all 0.3s ease; font-size:13px; font-weight:500; display:flex; align-items:center; gap:5px; }
.view-btn { background:#667eea; color:white; }
.view-btn:hover { background:#5a6ddd; transform:translateY(-2px); box-shadow:0 4px 8px rgba(102,126,234,0.3); }
.download-btn { background:#4caf50; color:white; }
.download-btn:hover { background:#45a049; transform:translateY(-2px); box-shadow:0 4px 8px rgba(76,175,80,0.3); }
.delete-btn { background:#f44336; color:white; }
.delete-btn:hover { background:#d32f2f; transform:translateY(-2px); box-shadow:0 4px 8px rgba(244,67,54,0.3); }

/* 空狀態 */
.empty-state { text-align:center; padding:80px 20px; color:#666; }
.empty-state i { font-size:80px; color:#ddd; margin-bottom:25px; display:inline-block; animation:float 3s ease-in-out infinite; }
@keyframes float { 0%, 100% { transform:translateY(0px); } 50% { transform:translateY(-10px); } }
.empty-state p { font-size:18px; margin-bottom:10px; color:#888; }
.empty-state a { display:inline-block; padding:12px 30px; background:#667eea; color:white; text-decoration:none; border-radius:8px; transition:all 0.3s ease; }
.empty-state a:hover { background:#5a6ddd; transform:translateY(-2px); }

@media (max-width:768px) { .main { flex-direction:column; } .sidebar { position:absolute; top:70px; left:-100%; width:200px; height:calc(100% - 70px); z-index:999; padding-top:20px; } .sidebar.active { left:0; } .content { padding:20px; } .files-container { padding:20px; } .toolbar { flex-direction:column; } .stats-grid { grid-template-columns:1fr; } .file-item { flex-wrap:wrap; gap:12px; } .file-info { width:100%; } .btn-group { width:100%; justify-content:flex-end; } }
@media (max-width:480px) { .header { padding:0 15px; } .header img.logo { height:40px; } .header-right { gap:10px; } .icon,.avatar { width:32px; height:32px; font-size:14px; } .file-item { padding:12px; } .file-name { font-size:14px; } .btn-group { flex-wrap:wrap; gap:6px; } .view-btn, .download-btn, .delete-btn { padding:6px 12px; font-size:12px; } }
</style>
</head>
<body>
<div class="header">
  <img src="image/logo1.gif" alt="Logo" onclick="location.href='student_index.html'" class="logo">
  <div class="header-right">
    <div class="icon"><i class="fas fa-bell"></i></div>
    <div class="avatar" onclick="toggleMenu()"><i class="fas fa-user"></i></div>
    <div id="userMenu" class="dropdown-menu">
      <a href="#" onclick="logout()"><i class="fas fa-sign-out-alt" style="margin-right:8px;"></i>登出</a>
    </div>
  </div>
</div>

<div class="main">
  <div class="sidebar" id="sidebar">
    <div class="menu">
      <a href="student_index.html"><i class="fas fa-home"></i>學生首頁</a>
      <a href="student_activities.html"><i class="fas fa-calendar-alt"></i>活動行事曆</a>
      <a href="student_registration.html"><i class="fas fa-user-plus"></i>線上報名</a>
      <a href="student_activities_modify.html"><i class="fas fa-edit"></i>活動報名修改</a>
      <a href="student_profile.html"><i class="fas fa-user-circle"></i>查看個人活動紀錄</a>
      <a href="student_upload.html"><i class="fas fa-cloud-upload-alt"></i>檔案上傳</a>
      <a href="student_files.html" class="active"><i class="fas fa-folder-open"></i>查看上傳檔案</a>
      <a href="student_from.html"><i class="fas fa-chart-pie"></i>填寫活動回饋</a>
      <a href="student_image.html"><i class="fas fa-image"></i>活動相簿</a>
    </div>
  </div>

  <div class="content">
    <div class="files-container">
      <h2><i class="fas fa-folder-open"></i> 已上傳檔案</h2>
      <p class="subtitle">管理您的所有上傳檔案</p>

      <div id="statsSection" style="display:none;">
        <div class="stats-grid">
          <div class="stat-card">
            <div class="value" id="totalFiles">0</div>
            <div class="label">總檔案數</div>
          </div>
          <div class="stat-card">
            <div class="value" id="totalSize">0 MB</div>
            <div class="label">總容量</div>
          </div>
          <div class="stat-card">
            <div class="value" id="selectedCount">0</div>
            <div class="label">已選擇</div>
          </div>
        </div>

        <div class="toolbar">
          <div class="search-box">
            <input type="text" id="searchInput" placeholder="搜尋檔案名稱..." onkeyup="filterFiles()">
            <i class="fas fa-search"></i>
          </div>
          <select class="filter-select" id="typeFilter" onchange="filterFiles()">
            <option value="all">所有類型</option>
            <option value="image">圖片</option>
            <option value="pdf">PDF</option>
            <option value="word">Word</option>
            <option value="other">其他</option>
          </select>
          <select class="sort-select" id="sortSelect" onchange="sortFiles()">
            <option value="date-desc">上傳時間 (最新)</option>
            <option value="date-asc">上傳時間 (最舊)</option>
            <option value="name-asc">檔案名稱 (A→Z)</option>
            <option value="name-desc">檔案名稱 (Z→A)</option>
            <option value="size-desc">檔案大小 (大→小)</option>
            <option value="size-asc">檔案大小 (小→大)</option>
          </select>
        </div>

        <div class="batch-actions">
          <button class="btn-batch btn-select-all" onclick="toggleSelectAll()">
            <i class="fas fa-check-square"></i> <span id="selectAllText">全選</span>
          </button>
          <button class="btn-batch btn-delete-selected" id="deleteSelectedBtn" onclick="deleteSelected()" disabled>
            <i class="fas fa-trash"></i> 刪除所選 (<span id="selectedCountText">0</span>)
          </button>
        </div>
      </div>

      <div id="filesList"></div>
    </div>
  </div>
</div>

<script>
let allFiles = [];
let displayedFiles = [];
let selectedFiles = [];

function loadFiles() {
  allFiles = JSON.parse(localStorage.getItem('uploadedFiles')||'[]');
  displayedFiles = [...allFiles];
  
  if (allFiles.length === 0) {
    showEmptyState();
  } else {
    document.getElementById('statsSection').style.display = 'block';
    updateStats();
    sortFiles();
  }
}

function showEmptyState() {
  document.getElementById('statsSection').style.display = 'none';
  document.getElementById('filesList').innerHTML = `
    <div class="empty-state">
      <div><i class="fas fa-folder-open"></i></div>
      <p>目前尚未上傳任何檔案</p>
    </div>
  `;
}

function updateStats() {
  const totalSize = allFiles.reduce((sum, f) => sum + (f.size || 0), 0);
  document.getElementById('totalFiles').textContent = allFiles.length;
  document.getElementById('totalSize').textContent = formatFileSize(totalSize);
  document.getElementById('selectedCount').textContent = selectedFiles.length;
  document.getElementById('selectedCountText').textContent = selectedFiles.length;
  document.getElementById('deleteSelectedBtn').disabled = selectedFiles.length === 0;
}

function renderFiles() {
  const filesListEl = document.getElementById('filesList');
  filesListEl.innerHTML = '';
  
  if (displayedFiles.length === 0) {
    filesListEl.innerHTML = '<p style="text-align:center;color:#666;padding:40px;">沒有符合條件的檔案</p>';
    return;
  }

  displayedFiles.forEach((file, index) => {
    const fileType = getFileType(file.name);
    const fileIcon = getFileIcon(fileType);
    const isSelected = selectedFiles.includes(file.id);
    
    const div = document.createElement('div');
    div.className = 'file-item' + (isSelected ? ' selected' : '');
    div.innerHTML = `
      <input type="checkbox" class="file-checkbox" ${isSelected ? 'checked' : ''} onchange="toggleFileSelection(${file.id})">
      <div class="file-info">
        <div class="file-icon ${fileType}">
          <i class="fas ${fileIcon}"></i>
        </div>
        <div class="file-details">
          <div class="file-name" title="${file.name}">${file.name}</div>
          <div class="file-meta">
            <span><i class="fas fa-hdd"></i> ${formatFileSize(file.size)}</span>
            <span><i class="fas fa-calendar"></i> ${formatDate(file.uploadDate)}</span>
          </div>
        </div>
      </div>
      <div class="btn-group">
        <button class="view-btn" onclick="viewFile('${file.url}')">
          <i class="fas fa-eye"></i> 檢視
        </button>
        <button class="download-btn" onclick="downloadFile('${file.url}','${file.name}')">
          <i class="fas fa-download"></i> 下載
        </button>
        <button class="delete-btn" onclick="deleteFile(${file.id})">
          <i class="fas fa-trash"></i> 刪除
        </button>
      </div>
    `;
    filesListEl.appendChild(div);
  });
}

function toggleFileSelection(fileId) {
  const index = selectedFiles.indexOf(fileId);
  if (index > -1) {
    selectedFiles.splice(index, 1);
  } else {
    selectedFiles.push(fileId);
  }
  updateStats();
  renderFiles();
}

function toggleSelectAll() {
  if (selectedFiles.length === displayedFiles.length) {
    selectedFiles = [];
    document.getElementById('selectAllText').textContent = '全選';
  } else {
    selectedFiles = displayedFiles.map(f => f.id);
    document.getElementById('selectAllText').textContent = '取消全選';
  }
  updateStats();
  renderFiles();
}

function filterFiles() {
  const searchTerm = document.getElementById('searchInput').value.toLowerCase();
  const typeFilter = document.getElementById('typeFilter').value;
  
  displayedFiles = allFiles.filter(file => {
    const matchesSearch = file.name.toLowerCase().includes(searchTerm);
    const matchesType = typeFilter === 'all' || getFileType(file.name) === typeFilter;
    return matchesSearch && matchesType;
  });
  
  sortFiles();
}

function sortFiles() {
  const sortBy = document.getElementById('sortSelect').value;
  
  displayedFiles.sort((a, b) => {
    switch(sortBy) {
      case 'date-desc':
        return new Date(b.uploadDate) - new Date(a.uploadDate);
      case 'date-asc':
        return new Date(a.uploadDate) - new Date(b.uploadDate);
      case 'name-asc':
        return a.name.localeCompare(b.name);
      case 'name-desc':
        return b.name.localeCompare(a.name);
      case 'size-desc':
        return (b.size || 0) - (a.size || 0);
      case 'size-asc':
        return (a.size || 0) - (b.size || 0);
      default:
        return 0;
    }
  });
  
  renderFiles();
}

function deleteFile(fileId) {
  if (!confirm('確定要刪除此檔案嗎？')) return;
  
  allFiles = allFiles.filter(f => f.id !== fileId);
  selectedFiles = selectedFiles.filter(id => id !== fileId);
  localStorage.setItem('uploadedFiles', JSON.stringify(allFiles));
  
  if (allFiles.length === 0) {
    showEmptyState();
  } else {
    filterFiles();
    updateStats();
  }
}

function deleteSelected() {
  if (selectedFiles.length === 0) return;
  if (!confirm(`確定要刪除所選的 ${selectedFiles.length} 個檔案嗎？此操作無法復原。`)) return;
  
  allFiles = allFiles.filter(f => !selectedFiles.includes(f.id));
  selectedFiles = [];
  localStorage.setItem('uploadedFiles', JSON.stringify(allFiles));
  
  if (allFiles.length === 0) {
    showEmptyState();
  } else {
    filterFiles();
    updateStats();
  }
}

function viewFile(url) {
  window.open(url, '_blank');
}

function downloadFile(url, name) {
  const a = document.createElement('a');
  a.href = url;
  a.download = name;
  document.body.appendChild(a);
  a.click();
  document.body.removeChild(a);
}

function getFileType(fileName) {
  const ext = fileName.split('.').pop().toLowerCase();
  if (['jpg', 'jpeg', 'png', 'gif', 'bmp', 'webp'].includes(ext)) return 'image';
  if (ext === 'pdf') return 'pdf';
  if (['doc', 'docx'].includes(ext)) return 'word';
  return 'other';
}

function getFileIcon(fileType) {
  const icons = {
    'image': 'fa-file-image',
    'pdf': 'fa-file-pdf',
    'word': 'fa-file-word',
    'other': 'fa-file'
  };
  return icons[fileType] || 'fa-file';
}

function formatFileSize(bytes) {
  if (!bytes || bytes === 0) return '0 Bytes';
  const k = 1024;
  const sizes = ['Bytes', 'KB', 'MB', 'GB'];
  const i = Math.floor(Math.log(bytes) / Math.log(k));
  return Math.round(bytes / Math.pow(k, i) * 100) / 100 + ' ' + sizes[i];
}

function formatDate(dateString) {
  if (!dateString) return '未知';
  const date = new Date(dateString);
  const year = date.getFullYear();
  const month = String(date.getMonth() + 1).padStart(2, '0');
  const day = String(date.getDate()).padStart(2, '0');
  const hours = String(date.getHours()).padStart(2, '0');
  const minutes = String(date.getMinutes()).padStart(2, '0');
  return `${year}/${month}/${day} ${hours}:${minutes}`;
}

function toggleMenu() {
  const menu = document.getElementById('userMenu');
  menu.style.display = (menu.style.display === 'flex') ? 'none' : 'flex';
}

function logout() {
  location.href = 'login_student.html';
}

document.addEventListener('click', (e) => {
  const avatar = document.querySelector('.avatar');
  const menu = document.getElementById('userMenu');
  if (!avatar.contains(e.target) && !menu.contains(e.target)) {
    menu.style.display = 'none';
  }
});

loadFiles();
</script>
</body>
</html>